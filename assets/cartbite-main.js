window.initVar||(window.initVar={apiUrl:"https://cartbite-app-api.staqlab.com/grow",serviceWorkerUrl:"/apps/grow/grow/api/p/js/sw.js",subscriberNewUniqueIdUrl:"https://cartbite-app-api.staqlab.com/grow/api/subscribers/uniqueId",clientStatusUrl:"https://cartbite-app-api.staqlab.com/grow/api/clientStatus",clickNotificationUrl:"https://cartbite-app-api.staqlab.com/grow/api/workflows/event",subscribeUrl:"https://cartbite-app-api.staqlab.com/grow/api/subscriber",meta:{},vapidKey:"BAy2Crqb6ycznZqcTHKHmiVJ0ZgpzQKbTnhuMgPM6ddyBl3sVe8OHjRM57546ZFGrIlxunuIYxxnlUrD3qbW9bM",clientId:"5EI8IGBKBMI2TTYUUWMLRBMS",pushOptInSetting:{delay:86400,message:{body:"We will notify you about new products and exclusive promotions",title:"Never miss a sale",buttons:[{label:"Later",order:1},{label:"Allow",order:2}],iconUrl:"https://stlf.nyc3.cdn.digitaloceanspaces.com/stq/bell_oprzpo.png"},isEnabled:!1,showModal:!0,initialDelay:10},subscriberId:"",stockFulFilledPushCampaign:{isActive:!0,uniqueId:"6TYWR13Y2CWG44FN3HGCYX68"},stockFulFilledEmailCampaign:{isActive:!0,uniqueId:"KANZZRBCTF1YHRTAZWP4J75J"},stockFulFilledSmsCampaign:{isActive:!0,uniqueId:"6U9VUDPNWMLEMWULACIE3R3N"},priceDropPushCampaign:{isActive:!0,uniqueId:"EM9NKQ66HKRCGUQIJGID2LKU"},priceDropEmailCampaign:{isActive:!0,uniqueId:"7EGJ591QIJNADBT1PSWAFSVL"},priceDropSmsCampaign:{isActive:!0,uniqueId:"VTUKYJS6G5R22M5X16PZT938"},stockWidget:{selector:"gw-stock-fulfilled",isEnabled:!1,popupSelector:"gw-stock-fulfilled-iframe",buttonType:"float",inlineButtonParentSelector:"",backgroundColor:"#000000",textColor:"#ffffff",subscriptionText:"Notify me when available",subscribedText:"We will notify you when the item is available",modalHtml:"{stockWidgetModalHtml}",showIfAnyVariantIsOutOfStock:!1},priceDropWidget:{selector:"gw-price-drop",isEnabled:!1,popupSelector:"gw-price-drop-iframe",buttonType:"float",inlineButtonParentSelector:"",backgroundColor:"#000000",textColor:"#ffffff",subscriptionText:"Notify me when price drops",subscribedText:"We will notify you when price drops",modalHtml:"{priceDropModalHtml}"},customJs:"null",customCss:"null",dataVariantId:"data-variant-id",dataProductId:"data-product-id",dataProductHandle:"data-product-handle",clickedProductId:null,clickedProductHandle:null,clickedVariantId:null,defaultCountry:"",addFloatWidget:function(t,n,r,i,o,a){let s=document.createElement("button");s.setAttribute(n,""),s.classList="btn button Button gw-float-widget",s.type="button",s.innerText=t,s.setAttribute(initVar.dataProductId,i),s.setAttribute(initVar.dataVariantId,o),s.setAttribute(initVar.dataProductHandle,a),s.onclick=t=>r(t),document.body.appendChild(s)},setStockFulFilledVariantOptions:async function(){let t=window.growCampaignPopUps[initVar.stockWidget.popupSelector].$data;if(!initVar.clickedProductId)return -1;{let n=await this.getProduct(initVar.clickedProductHandle);t.variants=n.variants.filter(t=>!initVar.checkIfInStock(t,n)).map(t=>({text:t.title,value:t.id}));if(!t.variants.find(t=>t.value===initVar.clickedVariantId)){let r=initVar.getValueIfExist(()=>t.variants[0].value);r&&(initVar.clickedVariantId=r)}t.selectedVariant=initVar.clickedVariantId,t.variantKey="vk-"+new Date().valueOf()}},setPriceDropVariantOptions:async function(){let t=window.growCampaignPopUps[initVar.priceDropWidget.popupSelector].$data;if(!initVar.clickedProductId)return -1;{let n=await this.getProduct(initVar.clickedProductHandle);t.variants=n.variants.map(t=>({text:t.title,value:t.id})),t.selectedVariant=initVar.clickedVariantId,t.variantKey="vk-"+new Date().valueOf()}},variantChangedFromModal:function(t){initVar.clickedVariantId=t},stockWidgetClicked:async function(t){growConfig.performTranslation(),initVar.clickedProductId=initVar.getValueIfExist(()=>Number(t.target.attributes[initVar.dataProductId].value)),initVar.clickedProductHandle=initVar.getValueIfExist(()=>t.target.attributes[initVar.dataProductHandle].value),initVar.clickedVariantId=initVar.getValueIfExist(()=>Number(t.target.attributes[initVar.dataVariantId].value)),document.getElementById(initVar.stockWidget.popupSelector).style.display="block",initVar.setStockFulFilledVariantOptions(),await growClient.isPushConsentGiven()&&await initVar.sendSubscriptionRequest(initVar.stockFulFilledPushCampaign.uniqueId)},waitForEvent:async function(t,n,r){let i=0;for(;i<r;){let o=await n();if(o)return o;await new Promise(n=>{setTimeout(()=>{n()},t)}),i++}return!1},addToCartClicked:async function(t){console.log("cart clicked");let n;if(!await initVar.waitForEvent(100,async()=>(n=await initVar.getCart()).items&&n.items.length,10))return;let r=`${initVar.apiUrl}/api/subscribers/cartMapping`,i={clientId:initVar.clientId,cartToken:n.token,subscriberUniqueId:initVar.subscriberId,cartJson:{token:n.token,items:n.items.map(t=>({product_id:t.product_id,product_title:t.product_title,image:initVar.getValueIfExist(()=>t.image.split("?")[0]),variant_id:t.variant_id,variant_title:t.variant_title,price:t.price}))}};fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})},checkEmail:function(t){return/\S+@\S+\.\S+/.test(t)},checkPhoneNumber:function(t){return!(Number.isNaN(t=t.replace(/-/g,"").replace(/ /g,"").replace(/\(/g,"").replace(/\)/g,""))||parseInt(t)!==Number(t)||100>parseInt(t))},priceDropClicked:async function(t){growConfig.performTranslation(),initVar.clickedProductId=initVar.getValueIfExist(()=>Number(t.target.attributes[initVar.dataProductId].value)),initVar.clickedProductHandle=initVar.getValueIfExist(()=>t.target.attributes[initVar.dataProductHandle].value),initVar.clickedVariantId=initVar.getValueIfExist(()=>Number(t.target.attributes[initVar.dataVariantId].value)),document.getElementById(initVar.priceDropWidget.popupSelector).style.display="block",initVar.setPriceDropVariantOptions(),await growClient.isPushConsentGiven()&&await initVar.sendSubscriptionRequest(initVar.priceDropPushCampaign.uniqueId),document.querySelectorAll(`[${initVar.priceDropWidget.selector}]`)[0].innerText=initVar.priceDropWidget.subscribedText},sendSubscriptionRequest:async function(t,n){let r=null,i=null;try{if(initVar.clickedProductHandle&&"undefined"!==initVar.clickedProductHandle){let o=await (await fetch(`${initVar.clickedProductHandle}.js`)).json();initVar.processProduct(o);let a=o.variants.find(t=>t.id===initVar.clickedVariantId);a&&(console.log("Clicked Variant Found"),r=o,i=a)}}catch(s){console.log(s)}r&&i||(console.error("Parsing Variant from Url"),i=await initVar.getSelectedVariant(r=await initVar.getProduct()));let u={productId:Number(r.id),productPrice:Number(i.price),variantId:i.id,variantPrice:Number(i.price),productTitle:r.title,variantTitle:i.title};r.id!==initVar.clickedProductId&&console.error("Error in check product id attribute"),i.id!==initVar.clickedVariantId&&console.error("Error in check variant id attribute");let c={campaignUniqueId:t,subscriberUniqueId:initVar.subscriberId,email:n&&n.email,smsTarget:n&&n.smsTarget,smsDialCode:n&&n.smsDialCode,optInToMarketing:n&&n.optInToMarketing,subscriptionEvent:u},l=`${initVar.apiUrl}/api/subscribers/campaignMapping`;fetch(l,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)})},getSubscriptionEvent:async function(t,n){let r=`${initVar.apiUrl}/api/subscribers/campaignMapping?campaignUniqueId=${t}&subscriberUniqueId=${initVar.subscriberId}&variantId=${n}`;return await (await fetch(r)).json()},getProduct:async function(t){if(!window.product||window.product.id!==product.id||!window.product.variants||!window.product.length){let n;try{n=await (await fetch(`${t=t||window.location.href.split("?")[0].split("#")[0]}.js`)).json()}catch(r){console.log("Error in fetching product",r)}window.product=n,initVar.processProduct(window.product)}return window.product},processProduct:function(t){return t.variants.forEach(t=>{t.price=t.price/100}),t},getCart:async function(){let t;try{return(t=await (await fetch("/cart.js")).json()).items.forEach(t=>{t.price=t.price/100}),t}catch(n){console.log("Error in fetching product",n)}},getQueryParam:function(t){var n;let r,i;return(r=(n=(n=location.search.slice(1))||location.search.slice(1)).split("&"),i={},r.forEach(function(t){let n=t.split("="),r=n[0],o=decodeURIComponent(n[1]||"");i[r]?"[object Array]"===Object.prototype.toString.call(i[r])?i[r].push(o):i[r]=[i[r],o]:i[r]=o}),JSON.parse(JSON.stringify(i)))[t]},getOptionValue:async function(t){let n=this.getValueIfExist(()=>initVar.getVariantSelector(t).find(t=>"radio"===t.type&&!0===t.checked||"radio"!==t.type).value);return n||(n=this.getValueIfExist(()=>{let n=initVar.getVariantSelector(t).find(t=>{if("LI"===t.tagName)return t.className.includes("is-selected")});if(n)return n.getAttribute("data-escape")})),n},getSelectedVariant:async function(t){let n="";if(!n){let r=await initVar.getOptionValue(1)||null,i=await initVar.getOptionValue(2)||null,o=await initVar.getOptionValue(3)||null;console.log(r,i,o);let a=t.variants.find(t=>t.option1===r&&t.option2===i&&t.option3===o);a&&(n=a.id)}if(console.log(n,"by options"),n||(n=parseInt(initVar.getQueryParam("variant"))),!n){n=parseInt(ShopifyAnalytics&&ShopifyAnalytics.meta&&ShopifyAnalytics.meta.selectedVariantId);t.variants.find(t=>Number(t.id)===Number(n))||(n=null)}return n||1!==t.variants.length||(n=t.variants[0].id),n||!1===initVar.selectFirstVariant||(n=(t.variants.find(t=>t.available)||t.variants[0]).id),t.variants.find(t=>Number(t.id)===Number(n))},getValueIfExist:function(t){try{return t()}catch(n){return}},closePopUp:function(t){document.getElementById(t).style.display="none"},campaignPopUpNotifyButtonClicked:async function(t,n,r,i){[initVar.stockFulFilledEmailCampaign.uniqueId,initVar.priceDropEmailCampaign.uniqueId].some(t=>t===n)&&await initVar.sendSubscriptionRequest(n,{email:r,optInToMarketing:i}),[initVar.stockFulFilledSmsCampaign.uniqueId,initVar.priceDropSmsCampaign.uniqueId].some(t=>t===n)&&await initVar.sendSubscriptionRequest(n,{smsTarget:r.smsTarget,smsDialCode:r.smsDialCode,optInToMarketing:i}),[initVar.stockFulFilledEmailCampaign.uniqueId,initVar.stockFulFilledSmsCampaign.uniqueId].some(t=>t===n)&&(document.querySelectorAll(`[${initVar.stockWidget.selector}]`)[0].innerText=initVar.stockWidget.subscribedText),console.log(t,r,n)},addPopUp:function(t,n){if(console.log("addPopup"),!document.getElementById(t)){let r=document.createElement("iframe");r.style.display="hidden",r.id=t,r.className="gw-modal",r.srcdoc=n,document.body.appendChild(r)}},renderStockWidget:async function(t,n){for(this.addPopUp(initVar.stockWidget.popupSelector,initVar.stockWidget.modalHtml);document.querySelectorAll(`[${initVar.stockWidget.selector}]`).length>0;)document.querySelectorAll(`[${initVar.stockWidget.selector}]`)[0].parentNode.removeChild(document.querySelectorAll(`[${initVar.stockWidget.selector}]`)[0]);if(!initVar.stockWidget.isEnabled)return;let r=!1;if(initVar.stockWidget.showIfAnyVariantIsOutOfStock&&(r=t.variants.some(n=>!initVar.checkIfInStock(n,t))),!initVar.checkIfInStock(n,t)||r){let i=initVar.stockWidget.subscriptionText;"float"===initVar.stockWidget.buttonType&&initVar.addFloatWidget(i,initVar.stockWidget.selector,initVar.stockWidgetClicked,t&&t.id,n&&n.id,t&&t.handle),window.addStockFulfilledButton?window.addStockFulfilledButton():initVar.addStockFulfilledButton(t&&t.id,n&&n.id,t&&t.handle)}},renderPriceDropWidget:async function(t,n){for(this.addPopUp(initVar.priceDropWidget.popupSelector,initVar.priceDropWidget.modalHtml);document.querySelectorAll(`[${initVar.priceDropWidget.selector}]`).length>0;)document.querySelectorAll(`[${initVar.priceDropWidget.selector}]`)[0].parentNode.removeChild(document.querySelectorAll(`[${initVar.priceDropWidget.selector}]`)[0]);if(initVar.priceDropWidget.isEnabled&&initVar.checkIfInStock(n,t)){let r=initVar.priceDropWidget.subscriptionText;"float"===initVar.priceDropWidget.buttonType&&initVar.addFloatWidget(r,initVar.priceDropWidget.selector,initVar.priceDropClicked,t&&t.id,n&&n.id,t&&t.handle),window.addPriceDropButton?window.addPriceDropButton():initVar.addPriceDropButton(t&&t.id,n&&n.id,t&&t.handle)}},checkIfInStock:function(t,n){return!!t.available},afterVariantChangeFn:function(){},onVariantChange:async function(){try{if(!initVar.processingOnVariantChange){initVar.processingOnVariantChange=!0;let t=await initVar.getProduct(),n=await initVar.getSelectedVariant(t);await initVar.renderStockWidget(t,n),await initVar.renderPriceDropWidget(t,n),initVar.processingOnVariantChange=!1,console.log("Grow Variant Change title",n.title),initVar.getValueIfExist(()=>initVar.afterVariantChangeFn())}}catch(r){console.log(r),initVar.processingOnVariantChange=!1}},performTranslation:function(){growConfig.translateContent&&growConfig.translateContent()},registerOnVariantChange:function(){let t=document.URL;document.addEventListener("change",function(){let n=document.URL,r=new URL(n).searchParams.get("variant");(n=r?n:r)&&t!==n&&(t=n,console.log("Grow Url Variant change variant_id: "+r),window.growConfig.onVariantChange())}),[1,2,3].forEach(t=>{initVar.getValueIfExist(()=>{initVar.getVariantSelector(t).forEach(t=>{t.addEventListener("change",window.growConfig.onVariantChange),"LI"===t.tagName&&t.addEventListener("click",()=>{setTimeout(()=>{window.growConfig.onVariantChange()},500)})})})})},getVariantSelector:function(t){let n=document.querySelectorAll(`[data-index="option${t}"]`)||document.querySelectorAll(`#Option-product-${t-1}`);return n&&n.length&&0!==n.length||(n=document.querySelectorAll(`#Option-product-${t-1}`)),n&&n.length&&0!==n.length||(n=document.querySelectorAll(`#nt_select_ppr_${t-1} li`)),[...n]},registerAddToCartChange:function(){initVar.getValueIfExist(()=>{(document.querySelector('[name="add"]')||document.querySelector('[data-action="add-to-cart"]')||document.querySelector("[data-add-to-cart]")).addEventListener("click",window.growConfig.addToCartClicked)})},isPostPurchasePage:function(){return window.Shopify&&Shopify.Checkout&&("thank_you"===Shopify.Checkout.page||Shopify.Checkout.isOrderStatusPage)},isCartPage:function(){return window.location.href.includes("cart")},sendOrderPurchaseEvent:async function(t){let n=await t.getNotificationsClicked();if(n.length){let r=`${initVar.apiUrl}/api/workflows/event`;fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clientUniqueId:initVar.clientId,notificationWorkFlowUniqueId:null,subscriberUniqueId:initVar.subscriberId,eventData:{amount:Number(Shopify.checkout.subtotal_price),name:"purchase",notificationsClicked:n,checkoutToken:Shopify&&Shopify.Checkout&&Shopify.Checkout.token,orderStatusUrl:window.location.href,orderId:Shopify.checkout&&Shopify.checkout.order_id}})})}},registerUtmParameter:async function(){this.getQueryParam("cbn_campaign")&&await growClient.registerNotificationClick(this.getQueryParam("message_process_id"),this.getQueryParam("cbn_campaign"),this.getQueryParam("cbn_medium"))},addPriceDropButton:function(t,n,r){if(!0===initVar.addPriceDropButtonV2Enabled)return initVar.addPriceDropButtonV2(t,n,r);let i=window.priceDropButtonParent;if("inline"!==initVar.priceDropWidget.buttonType||!i&&initVar.priceDropWidget.inlineButtonParentSelector&&!(i=document.querySelector(initVar.priceDropWidget.inlineButtonParentSelector)))return;let o=document.createElement("button");o.innerHTML=growConfig.priceDropWidget.subscriptionText,o.className="btn btn-success gw-button-widget",o.setAttribute("gw-price-drop",""),o.setAttribute(initVar.dataProductId,t),o.setAttribute(initVar.dataVariantId,n),o.setAttribute(initVar.dataProductHandle,r),o.style.backgroundColor=growConfig.priceDropWidget.backgroundColor,o.style.color=growConfig.priceDropWidget.textColor,o.onclick=t=>{t.preventDefault(),growConfig.priceDropClicked(t)},i.appendChild(o)},addStockFulfilledButton:function(t,n,r){if(!0===initVar.addStockFulfilledButtonV2Enabled)return initVar.addStockFulfilledButtonV2(t,n,r);let i=window.stockWidgetButtonParent;if("inline"!==initVar.stockWidget.buttonType||!i&&initVar.stockWidget.inlineButtonParentSelector&&!(i=document.querySelector(initVar.stockWidget.inlineButtonParentSelector)))return;let o=document.createElement("button");o.innerHTML=growConfig.stockWidget.subscriptionText,o.className="btn btn-success gw-button-widget",o.setAttribute("gw-stock-fulfilled",""),o.setAttribute(initVar.dataProductId,t),o.setAttribute(initVar.dataVariantId,n),o.setAttribute(initVar.dataProductHandle,r),o.style.backgroundColor=growConfig.stockWidget.backgroundColor,o.style.color=growConfig.stockWidget.textColor,o.onclick=t=>{t.preventDefault(),growConfig.stockWidgetClicked(t)},i.appendChild(o),this.campaignInlineButtonAddedEvent("gw-stock-fulfilled")},addStockFulfilledButtonV2:async function(t,n,r){if(console.log("Placing Inline Button"),"inline"!==initVar.stockWidget.buttonType)return;void 0===initVar.addToCartSelector&&(initVar.addToCartSelector="[name=add]"),void 0===initVar.addAddToCartClasses&&(initVar.addAddToCartClasses=!0),void 0===initVar.addToCartButtonClasses&&(initVar.addToCartButtonClasses="btn btn-success"),void 0===initVar.addAddToCartClassesIgnoreList&&(initVar.addAddToCartClassesIgnoreList="disabled");let i=document.querySelector(initVar.addToCartSelector),o=window.stockWidgetButtonParent;i&&initVar.addAddToCartClasses&&(initVar.addToCartButtonClasses=i.className.split(" ").filter(t=>!initVar.addAddToCartClassesIgnoreList.split(" ").some(n=>n==t)).join(" ")),!o&&(initVar.stockWidget.inlineButtonParentSelector?o=document.querySelector(initVar.stockWidget.inlineButtonParentSelector):i&&(o=i.parentNode));let a=document.createElement("button");a.innerHTML=growConfig.stockWidget.subscriptionText,a.className="gw-button-widget gw-button-widget-v2 "+initVar.addToCartButtonClasses,a.setAttribute("gw-stock-fulfilled",""),a.setAttribute(initVar.dataProductId,t),a.setAttribute(initVar.dataVariantId,n),a.setAttribute(initVar.dataProductHandle,r),a.style.backgroundColor=growConfig.stockWidget.backgroundColor,a.style.color=growConfig.stockWidget.textColor,a.onclick=t=>{t.preventDefault(),growConfig.stockWidgetClicked(t)},o||await initVar.waitForEvent(200,async()=>(console.log("Waiting for rendering of parent element of Inline button"),o),10),o.appendChild(a),this.campaignInlineButtonAddedEvent("gw-stock-fulfilled")},campaignInlineButtonAddedEvent:function(t){},addPriceDropButtonV2:function(t,n,r){if(console.log("Placing Inline Button"),"inline"!==initVar.priceDropWidget.buttonType)return;void 0===initVar.addToCartSelector&&(initVar.addToCartSelector="[name=add]"),void 0===initVar.addAddToCartClasses&&(initVar.addAddToCartClasses=!0),void 0===initVar.addToCartButtonClasses&&(initVar.addToCartButtonClasses="btn btn-success"),void 0===initVar.addAddToCartClassesIgnoreList&&(initVar.addAddToCartClassesIgnoreList="disabled");let i=document.querySelector(initVar.addToCartSelector),o=window.priceDropButtonParent;i&&initVar.addAddToCartClasses&&(initVar.addToCartButtonClasses=i.className.split(" ").filter(t=>!initVar.addAddToCartClassesIgnoreList.split(" ").some(n=>n==t)).join(" ")),!o&&(initVar.priceDropWidget.inlineButtonParentSelector?o=document.querySelector(initVar.priceDropWidget.inlineButtonParentSelector):i&&(o=i.parentNode));let a=document.createElement("button");a.innerHTML=growConfig.priceDropWidget.subscriptionText,a.className="gw-button-widget gw-button-widget-v2 "+initVar.addToCartButtonClasses,a.setAttribute("gw-price-drop",""),a.setAttribute(initVar.dataProductId,t),a.setAttribute(initVar.dataVariantId,n),a.setAttribute(initVar.dataProductHandle,r),a.style.backgroundColor=growConfig.priceDropWidget.backgroundColor,a.style.color=growConfig.priceDropWidget.textColor,a.onclick=t=>{t.preventDefault(),growConfig.priceDropClicked(t)},o.appendChild(a)}},window.growClient||(window.GrowClient=function(t){var n={};function r(i){if(n[i])return n[i].exports;var o=n[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=n,r.d=function(t,n,i){r.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:i})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,n){if(1&n&&(t=r(t)),8&n||4&n&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var o in t)r.d(i,o,(function(n){return t[n]}).bind(null,o));return i},r.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(n,"a",n),n},r.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},r.p="",r(r.s=1)}([function(t,n,r){"use strict";var i=this&&this.__awaiter||function(t,n,r,i){return new(r||(r=Promise))(function(o,a){function s(t){try{c(i.next(t))}catch(n){a(n)}}function u(t){try{c(i.throw(t))}catch(n){a(n)}}function c(t){var n;t.done?o(t.value):((n=t.value)instanceof r?n:new r(function(t){t(n)})).then(s,u)}c((i=i.apply(t,n||[])).next())})};Object.defineProperty(n,"__esModule",{value:!0}),n.DbKeys=n.DbManager=void 0;let o=r(2),a=r(3);class s extends o.default{constructor(){super("grow-db"),this.version(1).stores({configs:"++id,key,value"}),this.configs=this.table("configs")}static Instance(){return i(this,void 0,void 0,function*(){return s.instance||(s.instance=new s,yield s.instance.open().catch(t=>a.default.error(t))),s.instance})}save(t,n){return i(this,void 0,void 0,function*(){let r=yield this.find(t);(r=r||{key:t,value:n}).value=n;let i=yield this.configs.put(r);return this.configs.get(i)})}find(t){return i(this,void 0,void 0,function*(){return this.configs.where({key:t}).first()})}findValue(t){return i(this,void 0,void 0,function*(){let n=yield this.configs.where({key:t}).first();return n?n.value:null})}clear(t){return i(this,void 0,void 0,function*(){return this.configs.where({key:t}).delete()})}}n.DbManager=s;class u{}n.DbKeys=u,u.SubscriberId="subId",u.ClientId="clientId",u.NotificationsClicked="notifications-clicked",u.PushData="push",u.VapidPublicKey="vapid-public",u.IsActive="isActive-"+parseInt((new Date).valueOf()-(new Date).valueOf()%6e5),u.LastOptInAt="lastOptInAt"},function(t,n,r){"use strict";var i=this&&this.__awaiter||function(t,n,r,i){return new(r||(r=Promise))(function(o,a){function s(t){try{c(i.next(t))}catch(n){a(n)}}function u(t){try{c(i.throw(t))}catch(n){a(n)}}function c(t){var n;t.done?o(t.value):((n=t.value)instanceof r?n:new r(function(t){t(n)})).then(s,u)}c((i=i.apply(t,n||[])).next())})};Object.defineProperty(n,"__esModule",{value:!0}),n.GrowClient=void 0;let o=r(0),a=r(4);class s{constructor(){console.log("Init GrowClient")}init(t){return i(this,void 0,void 0,function*(){if(this.initVars=t,yield this.getClientStatus()){if(this.db=yield o.DbManager.Instance(),yield this.db.save(o.DbKeys.ClientId,this.initVars.clientId),!(yield this.db.findValue(o.DbKeys.SubscriberId))&&(yield this.db.save(o.DbKeys.SubscriberId,(yield this.getUniqueId()))),this.swRegistration=yield this.registerServiceWorker(),this.pushManager=new a.GrowPushManager(this.initVars,this.swRegistration),this.db.save(o.DbKeys.VapidPublicKey,t.vapidKey),!(yield this.checkNotificationSupport()))return Promise.reject("Notification Not Supported");if(!(yield this.checkServiceWorkerSupport()))return Promise.reject("Service Worker Not Supported");yield this.pushManager.init(),this.onInit&&(yield this.processOnInit())}})}processOnInit(){return i(this,void 0,void 0,function*(){let t=yield this.db.find(o.DbKeys.SubscriberId);t&&(yield this.onInit(t.value))})}registerServiceWorker(){return i(this,void 0,void 0,function*(){return yield navigator.serviceWorker.register(this.initVars.serviceWorkerUrl||"/sw.js").catch(t=>(console.error("Grow",t),Promise.reject(t)))})}checkServiceWorkerSupport(){return i(this,void 0,void 0,function*(){return"serviceWorker"in navigator?Promise.resolve(!0):Promise.resolve(!1)})}checkNotificationSupport(){return i(this,void 0,void 0,function*(){return"Notification"in window?Promise.resolve(!0):Promise.resolve(!1)})}getNotificationsClicked(){return i(this,void 0,void 0,function*(){this.db||(this.db=yield o.DbManager.Instance());let t=yield this.db.find(o.DbKeys.NotificationsClicked);return t?JSON.parse(t.value):[]})}getUniqueId(){return i(this,void 0,void 0,function*(){return yield fetch(this.initVars.subscriberNewUniqueIdUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})}).then(t=>i(this,void 0,void 0,function*(){return(yield t.json()).uniqueId}))})}getClientStatus(){return i(this,void 0,void 0,function*(){this.db||(this.db=yield o.DbManager.Instance());let t=yield this.db.findValue(o.DbKeys.IsActive);if(!t){try{t=yield fetch(this.initVars.clientStatusUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clientUniqueId:this.initVars.clientId})}).then(t=>i(this,void 0,void 0,function*(){return(yield t.json()).isActive+""}))}catch(n){console.log("Error getting client status",n),t="true"}return yield this.db.save(o.DbKeys.IsActive,t+""),"true"===t}return"true"===t})}registerNotificationClick(t,n,r){return i(this,void 0,void 0,function*(){this.db||(this.db=yield o.DbManager.Instance());let i=yield this.getSubscriberId(),a=yield this.db.find(o.DbKeys.NotificationsClicked),s=[];a&&(s=JSON.parse(a.value)||[]);let u={notificationWorkFlowUniqueId:n,notificationType:r,subscriberId:i,timestamp:(new Date).valueOf()};s.push(u),yield this.db.save(o.DbKeys.NotificationsClicked,JSON.stringify(s)),yield fetch(this.initVars.clickNotificationUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({uniqueId:t+"-"+i,clientUniqueId:this.initVars.clientId,notificationWorkFlowUniqueId:n,subscriberUniqueId:i,eventData:{name:"click",notificationType:r}})}).catch(t=>{console.error("error in sending click notification url",t)})})}getSubscriberId(){return i(this,void 0,void 0,function*(){return this.db||(this.db=yield o.DbManager.Instance()),yield this.db.findValue(o.DbKeys.SubscriberId)})}saveDbValue(t,n){return i(this,void 0,void 0,function*(){return this.db||(this.db=yield o.DbManager.Instance()),yield this.db.save(t,n),this.db.findValue(t)})}getDbValue(t){return i(this,void 0,void 0,function*(){return this.db||(this.db=yield o.DbManager.Instance()),yield this.db.findValue(t)})}isPushConsentGiven(){return i(this,void 0,void 0,function*(){return this.db||(this.db=yield o.DbManager.Instance()),yield this.db.findValue(o.DbKeys.PushData)})}}n.GrowClient=s;let u=new s;n.default=u},function(t,n,r){"use strict";r.r(n),r.d(n,"Dexie",function(){return no});var i=function(){return(i=Object.assign||function(t){for(var n,r=1,i=arguments.length;r<i;r++)for(var o in n=arguments[r])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t}).apply(this,arguments)};function o(){for(var t=0,n=0,r=arguments.length;n<r;n++)t+=arguments[n].length;var i=Array(t),o=0;for(n=0;n<r;n++)for(var a=arguments[n],s=0,u=a.length;s<u;s++,o++)i[o]=a[s];return i}var a=Object.keys,s=Array.isArray,u="undefined"!=typeof self?self:"undefined"!=typeof window?window:global;function c(t,n){return"object"!=typeof n||a(n).forEach(function(r){t[r]=n[r]}),t}"undefined"==typeof Promise||u.Promise||(u.Promise=Promise);var l=Object.getPrototypeOf,d={}.hasOwnProperty;function f(t,n){return d.call(t,n)}function h(t,n){"function"==typeof n&&(n=n(l(t))),a(n).forEach(function(r){y(t,r,n[r])})}var p=Object.defineProperty;function y(t,n,r,i){p(t,n,c(r&&f(r,"get")&&"function"==typeof r.get?{get:r.get,set:r.set,configurable:!0}:{value:r,configurable:!0,writable:!0},i))}function g(t){return{from:function(n){return t.prototype=Object.create(n.prototype),y(t.prototype,"constructor",t),{extend:h.bind(null,t.prototype)}}}}var v=Object.getOwnPropertyDescriptor;function m(t,n){var r;return v(t,n)||(r=l(t))&&m(r,n)}var b=[].slice;function $(t,n,r){return b.call(t,n,r)}function w(t,n){return n(t)}function k(t){if(!t)throw Error("Assertion Failed")}function C(t){u.setImmediate?setImmediate(t):setTimeout(t,0)}function x(t,n){return t.reduce(function(t,r,i){var o=n(r,i);return o&&(t[o[0]]=o[1]),t},{})}function _(t,n){if(f(t,n))return t[n];if(!n)return t;if("string"!=typeof n){for(var r=[],i=0,o=n.length;i<o;++i){var a=_(t,n[i]);r.push(a)}return r}var s=n.indexOf(".");if(-1!==s){var u=t[n.substr(0,s)];return void 0===u?void 0:_(u,n.substr(s+1))}}function I(t,n,r){if(t&&void 0!==n&&(!("isFrozen"in Object)||!Object.isFrozen(t))){if("string"!=typeof n&&"length"in n){k("string"!=typeof r&&"length"in r);for(var i=0,o=n.length;i<o;++i)I(t,n[i],r[i])}else{var a=n.indexOf(".");if(-1!==a){var u=n.substr(0,a),c=n.substr(a+1);if(""===c)void 0===r?s(t)&&!isNaN(parseInt(u))?t.splice(u,1):delete t[u]:t[u]=r;else{var l=t[u];l||(l=t[u]={}),I(l,c,r)}}else void 0===r?s(t)&&!isNaN(parseInt(n))?t.splice(n,1):delete t[n]:t[n]=r}}}function S(t,n){"string"==typeof n?I(t,n,void 0):"length"in n&&[].map.call(n,function(n){I(t,n,void 0)})}function P(t){var n={};for(var r in t)f(t,r)&&(n[r]=t[r]);return n}var T=[].concat;function E(t){return T.apply([],t)}var D="Boolean,String,Date,RegExp,Blob,File,FileList,ArrayBuffer,DataView,Uint8ClampedArray,ImageData,Map,Set".split(",").concat(E([8,16,32,64].map(function(t){return["Int","Uint","Float"].map(function(n){return n+t+"Array"})}))).filter(function(t){return u[t]}),A=D.map(function(t){return u[t]}),O=x(D,function(t){return[t,!0]});function K(t){if(!t||"object"!=typeof t)return t;if(s(t)){n=[];for(var n,r=0,i=t.length;r<i;++r)n.push(K(t[r]))}else if(A.indexOf(t.constructor)>=0)n=t;else for(var o in n=t.constructor?Object.create(t.constructor.prototype):{},t)f(t,o)&&(n[o]=K(t[o]));return n}var B={}.toString;function V(t){return B.call(t).slice(8,-1)}var M=function(t,n){return"Array"===n?""+t.map(function(t){return M(t,V(t))}):"ArrayBuffer"===n?""+new Uint8Array(t):"Date"===n?t.getTime():ArrayBuffer.isView(t)?""+new Uint8Array(t.buffer):t};function F(t,n,r,i){return r=r||{},i=i||"",a(t).forEach(function(o){if(f(n,o)){var a=t[o],s=n[o];if("object"==typeof a&&"object"==typeof s&&a&&s){var u=V(a),c=V(s);u===c?O[u]?M(a,u)!==M(s,c)&&(r[i+o]=n[o]):F(a,s,r,i+o+"."):r[i+o]=n[o]}else a!==s&&(r[i+o]=n[o])}else r[i+o]=void 0}),a(n).forEach(function(o){f(t,o)||(r[i+o]=n[o])}),r}var q="undefined"!=typeof Symbol&&Symbol.iterator,j=q?function(t){var n;return null!=t&&(n=t[q])&&n.apply(t)}:function(){return null},N={};function U(t){var n,r,i,o;if(1===arguments.length){if(s(t))return t.slice();if(this===N&&"string"==typeof t)return[t];if(o=j(t)){for(r=[];!(i=o.next()).done;)r.push(i.value);return r}if(null==t)return[t];if("number"==typeof(n=t.length)){for(r=Array(n);n--;)r[n]=t[n];return r}return[t]}for(n=arguments.length,r=Array(n);n--;)r[n]=arguments[n];return r}var R="undefined"!=typeof Symbol?function(t){return"AsyncFunction"===t[Symbol.toStringTag]}:function(){return!1},W="undefined"!=typeof location&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function L(t,n){W=t,H=n}var H=function(){return!0},G=!Error("").stack;function z(){if(G)try{throw Error()}catch(t){return t}return Error()}function Y(t,n){var r=t.stack;return r?(n=n||0,0===r.indexOf(t.name)&&(n+=(t.name+t.message).split("\n").length),r.split("\n").slice(n).filter(H).map(function(t){return"\n"+t}).join("")):""}var Q=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],J=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Q),Z={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed"};function X(t,n){this._e=z(),this.name=t,this.message=n}function ee(t,n){return t+". Errors: "+Object.keys(n).map(function(t){return n[t].toString()}).filter(function(t,n,r){return r.indexOf(t)===n}).join("\n")}function et(t,n,r,i){this._e=z(),this.failures=n,this.failedKeys=i,this.successCount=r,this.message=ee(t,n)}function en(t,n){this._e=z(),this.name="BulkError",this.failures=n,this.message=ee(t,n)}g(X).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+Y(this._e,2))}},toString:function(){return this.name+": "+this.message}}),g(et).from(X),g(en).from(X);var er=J.reduce(function(t,n){return t[n]=n+"Error",t},{}),ei=X,eo=J.reduce(function(t,n){var r=n+"Error";function i(t,i){this._e=z(),this.name=r,t?"string"==typeof t?(this.message=t+(i?"\n "+i:""),this.inner=i||null):"object"==typeof t&&(this.message=t.name+" "+t.message,this.inner=t):(this.message=Z[n]||r,this.inner=null)}return g(i).from(ei),t[n]=i,t},{});eo.Syntax=SyntaxError,eo.Type=TypeError,eo.Range=RangeError;var ea=Q.reduce(function(t,n){return t[n+"Error"]=eo[n],t},{}),es=J.reduce(function(t,n){return -1===["Syntax","Type","Range"].indexOf(n)&&(t[n+"Error"]=eo[n]),t},{});function eu(){}function ec(t){return t}function el(t,n){return null==t||t===ec?n:function(r){return n(t(r))}}function ed(t,n){return function(){t.apply(this,arguments),n.apply(this,arguments)}}function ef(t,n){return t===eu?n:function(){var r=t.apply(this,arguments);void 0!==r&&(arguments[0]=r);var i=this.onsuccess,o=this.onerror;this.onsuccess=null,this.onerror=null;var a=n.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?ed(i,this.onsuccess):i),o&&(this.onerror=this.onerror?ed(o,this.onerror):o),void 0!==a?a:r}}function eh(t,n){return t===eu?n:function(){t.apply(this,arguments);var r=this.onsuccess,i=this.onerror;this.onsuccess=this.onerror=null,n.apply(this,arguments),r&&(this.onsuccess=this.onsuccess?ed(r,this.onsuccess):r),i&&(this.onerror=this.onerror?ed(i,this.onerror):i)}}function ep(t,n){return t===eu?n:function(r){var i=t.apply(this,arguments);c(r,i);var o=this.onsuccess,a=this.onerror;this.onsuccess=null,this.onerror=null;var s=n.apply(this,arguments);return o&&(this.onsuccess=this.onsuccess?ed(o,this.onsuccess):o),a&&(this.onerror=this.onerror?ed(a,this.onerror):a),void 0===i?void 0===s?void 0:s:c(i,s)}}function ey(t,n){return t===eu?n:function(){return!1!==n.apply(this,arguments)&&t.apply(this,arguments)}}function eg(t,n){return t===eu?n:function(){var r=t.apply(this,arguments);if(r&&"function"==typeof r.then){for(var i=this,o=arguments.length,a=Array(o);o--;)a[o]=arguments[o];return r.then(function(){return n.apply(i,a)})}return n.apply(this,arguments)}}es.ModifyError=et,es.DexieError=X,es.BulkError=en;var ev={},em="undefined"==typeof Promise?[]:function(){var t=Promise.resolve();if("undefined"==typeof crypto||!crypto.subtle)return[t,t.__proto__,t];var n=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[n,n.__proto__,t]}(),eb=em[0],e$=em[1],ew=em[2],e8=e$&&e$.then,ek=eb&&eb.constructor,eC=!!ew,ex=!1,e_=ew?function(){ew.then(e0)}:u.setImmediate?setImmediate.bind(null,e0):u.MutationObserver?function(){var t=document.createElement("div");new MutationObserver(function(){e0(),t=null}).observe(t,{attributes:!0}),t.setAttribute("i","1")}:function(){setTimeout(e0,0)},eI=function(t,n){eB.push([t,n]),eP&&(e_(),eP=!1)},eS=!0,eP=!0,eT=[],eE=[],eD=null,eA=ec,eO={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:ts,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(function(t){try{ts(t[0],t[1])}catch(n){}})}},eK=eO,eB=[],eV=0,eM=[];function eF(t){if("object"!=typeof this)throw TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=eu,this._lib=!1;var n=this._PSD=eK;if(W&&(this._stackHolder=z(),this._prev=null,this._numPrev=0),"function"!=typeof t){if(t!==ev)throw TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(!1===this._state&&eN(this,this._value))}this._state=null,this._value=null,++n.ref,function t(n,r){try{r(function(r){if(null===n._state){if(r===n)throw TypeError("A promise cannot be resolved with itself.");var i=n._lib&&eH();r&&"function"==typeof r.then?t(n,function(t,n){r instanceof eF?r._then(t,n):r.then(t,n)}):(n._state=!0,n._value=r,eU(n)),i&&e2()}},eN.bind(null,n))}catch(i){eN(n,i)}}(this,t)}var eq={get:function(){var t=eK,n=e9;function r(r,i){var o=this,a=!t.global&&(t!==eK||n!==e9),s=a&&!e5(),u=new eF(function(n,u){eR(o,new ej(to(r,t,a,s),to(i,t,a,s),n,u,t))});return W&&eL(u,this),u}return r.prototype=ev,r},set:function(t){y(this,"then",t&&t.prototype===ev?eq:{get:function(){return t},set:eq.set})}};function ej(t,n,r,i,o){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof n?n:null,this.resolve=r,this.reject=i,this.psd=o}function eN(t,n){if(eE.push(n),null===t._state){var r,i=t._lib&&eH();n=eA(n),t._state=!1,t._value=n,W&&null!==n&&"object"==typeof n&&!n._promise&&function(t,n,r){try{t.apply(null,void 0)}catch(i){n&&n(i)}}(function(){var r=m(n,"stack");n._promise=t,y(n,"stack",{get:function(){return ex?r&&(r.get?r.get.apply(n):r.value):t.stack}})}),r=t,eT.some(function(t){return t._value===r._value})||eT.push(r),eU(t),i&&e2()}}function eU(t){var n=t._listeners;t._listeners=[];for(var r=0,i=n.length;r<i;++r)eR(t,n[r]);var o=t._PSD;--o.ref||o.finalize(),0===eV&&(++eV,eI(function(){0==--eV&&e3()},[]))}function eR(t,n){if(null!==t._state){var r=t._state?n.onFulfilled:n.onRejected;if(null===r)return(t._state?n.resolve:n.reject)(t._value);++n.psd.ref,++eV,eI(eW,[r,t,n])}else t._listeners.push(n)}function eW(t,n,r){try{eD=n;var i,o=n._value;n._state?i=t(o):(eE.length&&(eE=[]),i=t(o),-1===eE.indexOf(o)&&function(t){for(var n=eT.length;n;)if(eT[--n]._value===t._value)return void eT.splice(n,1)}(n)),r.resolve(i)}catch(a){r.reject(a)}finally{eD=null,0==--eV&&e3(),--r.psd.ref||r.psd.finalize()}}function eL(t,n){var r=n?n._numPrev+1:0;r<100&&(t._prev=n,t._numPrev=r)}function e0(){eH()&&e2()}function eH(){var t=eS;return eS=!1,eP=!1,t}function e2(){var t,n,r;do for(;eB.length>0;)for(t=eB,eB=[],r=t.length,n=0;n<r;++n){var i=t[n];i[0].apply(null,i[1])}while(eB.length>0);eS=!0,eP=!0}function e3(){var t=eT;eT=[],t.forEach(function(t){t._PSD.onunhandled.call(null,t._value,t)});for(var n=eM.slice(0),r=n.length;r;)n[--r]()}function e1(t){return new eF(ev,!1,t)}function e4(t,n){var r=eK;return function(){var i=eH(),o=eK;try{return tt(r,!0),t.apply(this,arguments)}catch(a){n&&n(a)}finally{tt(o,!1),i&&e2()}}}h(eF.prototype,{then:eq,_then:function(t,n){eR(this,new ej(null,null,t,n,eK))},catch:function(t){if(1===arguments.length)return this.then(null,t);var n=arguments[0],r=arguments[1];return"function"==typeof n?this.then(null,function(t){return t instanceof n?r(t):e1(t)}):this.then(null,function(t){return t&&t.name===n?r(t):e1(t)})},finally:function(t){return this.then(function(n){return t(),n},function(n){return t(),e1(n)})},stack:{get:function(){if(this._stack)return this._stack;try{ex=!0;var t=(function t(n,r,i){if(r.length===i)return r;var o="";if(!1===n._state){var a,s,u=n._value;null!=u?(a=u.name||"Error",s=u.message||u,o=Y(u,0)):(a=u,s=""),r.push(a+(s?": "+s:"")+o)}return W&&((o=Y(n._stackHolder,2))&&-1===r.indexOf(o)&&r.push(o),n._prev&&t(n._prev,r,i)),r})(this,[],20).join("\nFrom previous: ");return null!==this._state&&(this._stack=t),t}finally{ex=!1}}},timeout:function(t,n){var r=this;return t<1/0?new eF(function(i,o){var a=setTimeout(function(){return o(new eo.Timeout(n))},t);r.then(i,o).finally(clearTimeout.bind(null,a))}):this}}),"undefined"!=typeof Symbol&&Symbol.toStringTag&&y(eF.prototype,Symbol.toStringTag,"Dexie.Promise"),eO.env=tn(),h(eF,{all:function(){var t=U.apply(null,arguments).map(eZ);return new eF(function(n,r){0===t.length&&n([]);var i=t.length;t.forEach(function(o,a){return eF.resolve(o).then(function(r){t[a]=r,--i||n(t)},r)})})},resolve:function(t){if(t instanceof eF)return t;if(t&&"function"==typeof t.then)return new eF(function(n,r){t.then(n,r)});var n=new eF(ev,!0,t);return eL(n,eD),n},reject:e1,race:function(){var t=U.apply(null,arguments).map(eZ);return new eF(function(n,r){t.map(function(t){return eF.resolve(t).then(n,r)})})},PSD:{get:function(){return eK},set:function(t){return eK=t}},totalEchoes:{get:function(){return e9}},newPSD:eQ,usePSD:tr,scheduler:{get:function(){return eI},set:function(t){eI=t}},rejectionMapper:{get:function(){return eA},set:function(t){eA=t}},follow:function(t,n){return new eF(function(r,i){return eQ(function(n,r){var i=eK;i.unhandleds=[],i.onunhandled=r,i.finalize=ed(function(){var t,i=this;t=function(){0===i.unhandleds.length?n():r(i.unhandleds[0])},eM.push(function n(){t(),eM.splice(eM.indexOf(n),1)}),++eV,eI(function(){0==--eV&&e3()},[])},i.finalize),t()},n,r,i)})}}),ek&&(ek.allSettled&&y(eF,"allSettled",function(){var t=U.apply(null,arguments).map(eZ);return new eF(function(n){0===t.length&&n([]);var r=t.length,i=Array(r);t.forEach(function(t,o){return eF.resolve(t).then(function(t){return i[o]={status:"fulfilled",value:t}},function(t){return i[o]={status:"rejected",reason:t}}).then(function(){return--r||n(i)})})})}),ek.any&&"undefined"!=typeof AggregateError&&y(eF,"any",function(){var t=U.apply(null,arguments).map(eZ);return new eF(function(n,r){0===t.length&&r(AggregateError([]));var i=t.length,o=Array(i);t.forEach(function(t,a){return eF.resolve(t).then(function(t){return n(t)},function(t){o[a]=t,--i||r(AggregateError(o))})})})}));var eG={awaits:0,echoes:0,id:0},ez=0,e6=[],e7=0,e9=0,eY=0;function eQ(t,n,r,i){var o=eK,a=Object.create(o);a.parent=o,a.ref=0,a.global=!1,a.id=++eY;var s=eO.env;a.env=eC?{Promise:eF,PromiseProp:{value:eF,configurable:!0,writable:!0},all:eF.all,race:eF.race,allSettled:eF.allSettled,any:eF.any,resolve:eF.resolve,reject:eF.reject,nthen:ta(s.nthen,a),gthen:ta(s.gthen,a)}:{},n&&c(a,n),++o.ref,a.finalize=function(){--this.parent.ref||this.parent.finalize()};var u=tr(a,t,r,i);return 0===a.ref&&a.finalize(),u}function eJ(){return eG.id||(eG.id=++ez),++eG.awaits,eG.echoes+=100,eG.id}function e5(){return!!eG.awaits&&(0==--eG.awaits&&(eG.id=0),eG.echoes=100*eG.awaits,!0)}function eZ(t){return eG.echoes&&t&&t.constructor===ek?(eJ(),t.then(function(t){return e5(),t},function(t){return e5(),tu(t)})):t}function eX(t){++e9,eG.echoes&&0!=--eG.echoes||(eG.echoes=eG.id=0),e6.push(eK),tt(t,!0)}function te(){var t=e6[e6.length-1];e6.pop(),tt(t,!1)}function tt(t,n){var r=eK;if((n?!eG.echoes||e7++&&t===eK:!e7||--e7&&t===eK)||ti(n?eX.bind(null,t):te),t!==eK&&(eK=t,r===eO&&(eO.env=tn()),eC)){var i=eO.env.Promise,o=t.env;e$.then=o.nthen,i.prototype.then=o.gthen,(r.global||t.global)&&(Object.defineProperty(u,"Promise",o.PromiseProp),i.all=o.all,i.race=o.race,i.resolve=o.resolve,i.reject=o.reject,o.allSettled&&(i.allSettled=o.allSettled),o.any&&(i.any=o.any))}}function tn(){var t=u.Promise;return eC?{Promise:t,PromiseProp:Object.getOwnPropertyDescriptor(u,"Promise"),all:t.all,race:t.race,allSettled:t.allSettled,any:t.any,resolve:t.resolve,reject:t.reject,nthen:e$.then,gthen:t.prototype.then}:{}}function tr(t,n,r,i,o){var a=eK;try{return tt(t,!0),n(r,i,o)}finally{tt(a,!1)}}function ti(t){e8.call(eb,t)}function to(t,n,r,i){return"function"!=typeof t?t:function(){var o=eK;r&&eJ(),tt(n,!0);try{return t.apply(this,arguments)}finally{tt(o,!1),i&&ti(e5)}}}function ta(t,n){return function(r,i){return t.call(this,to(r,n),to(i,n))}}function ts(t,n){var r;try{r=n.onuncatched(t)}catch(i){}if(!1!==r)try{var o,a={promise:n,reason:t};if(u.document&&document.createEvent?((o=document.createEvent("Event")).initEvent("unhandledrejection",!0,!0),c(o,a)):u.CustomEvent&&c(o=new CustomEvent("unhandledrejection",{detail:a}),a),o&&u.dispatchEvent&&(dispatchEvent(o),!u.PromiseRejectionEvent&&u.onunhandledrejection))try{u.onunhandledrejection(o)}catch(s){}W&&o&&!o.defaultPrevented&&console.warn("Unhandled rejection: "+(t.stack||t))}catch(l){}}-1===(""+e8).indexOf("[native code]")&&(eJ=e5=eu);var tu=eF.reject,tc="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",tl=[],td="undefined"!=typeof navigator&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),tf=td,th=td,tp=function(t){return!/(dexie\.js|dexie\.min\.js)/.test(t)};function ty(t,n){return t?n?function(){return t.apply(this,arguments)&&n.apply(this,arguments)}:t:n}var tg={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function tv(t){return function(n){return void 0===_(n,t)&&S(n=K(n),t),n}}var tm=function(){function t(){}return t.prototype._trans=function(t,n,r){var i=this._tx||eK.trans,o=this.name;function a(t,r,i){if(!i.schema[o])throw new eo.NotFound("Table "+o+" not part of transaction");return n(i.idbtrans,i)}var s=eH();try{return i&&i.db===this.db?i===eK.trans?i._promise(t,a,r):eQ(function(){return i._promise(t,a,r)},{trans:i,transless:eK.transless||eK}):function t(n,r,i,o){if(n._state.openComplete||eK.letThrough){var a=n._createTransaction(r,i,n._dbSchema);try{a.create()}catch(s){return tu(s)}return a._promise(r,function(t,n){return eQ(function(){return eK.trans=a,o(t,n,a)})}).then(function(t){return a._completion.then(function(){return t})})}if(!n._state.isBeingOpened){if(!n._options.autoOpen)return tu(new eo.DatabaseClosed);n.open().catch(eu)}return n._state.dbReadyPromise.then(function(){return t(n,r,i,o)})}(this.db,t,[this.name],a)}finally{s&&e2()}},t.prototype.get=function(t,n){var r=this;return t&&t.constructor===Object?this.where(t).first(n):this._trans("readonly",function(n){return r.core.get({trans:n,key:t}).then(function(t){return r.hook.reading.fire(t)})}).then(n)},t.prototype.where=function(t){if("string"==typeof t)return new this.db.WhereClause(this,t);if(s(t))return new this.db.WhereClause(this,"["+t.join("+")+"]");var n=a(t);if(1===n.length)return this.where(n[0]).equals(t[n[0]]);var r=this.schema.indexes.concat(this.schema.primKey).filter(function(t){return t.compound&&n.every(function(n){return t.keyPath.indexOf(n)>=0})&&t.keyPath.every(function(t){return n.indexOf(t)>=0})})[0];if(r&&"ï¿¿"!==this.db._maxKey)return this.where(r.name).equals(r.keyPath.map(function(n){return t[n]}));!r&&W&&console.warn("The query "+JSON.stringify(t)+" on "+this.name+" would benefit of a compound index ["+n.join("+")+"]");var i=this.schema.idxByName,o=this.db._deps.indexedDB;function u(t,n){try{return 0===o.cmp(t,n)}catch(r){return!1}}var c=n.reduce(function(n,r){var o=n[0],a=n[1],c=i[r],l=t[r];return[o||c,o||!c?ty(a,c&&c.multi?function(t){var n=_(t,r);return s(n)&&n.some(function(t){return u(l,t)})}:function(t){return u(l,_(t,r))}):a]},[null,null]),l=c[0],d=c[1];return l?this.where(l.name).equals(t[l.keyPath]).filter(d):r?this.filter(d):this.where(n).equals("")},t.prototype.filter=function(t){return this.toCollection().and(t)},t.prototype.count=function(t){return this.toCollection().count(t)},t.prototype.offset=function(t){return this.toCollection().offset(t)},t.prototype.limit=function(t){return this.toCollection().limit(t)},t.prototype.each=function(t){return this.toCollection().each(t)},t.prototype.toArray=function(t){return this.toCollection().toArray(t)},t.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},t.prototype.orderBy=function(t){return new this.db.Collection(new this.db.WhereClause(this,s(t)?"["+t.join("+")+"]":t))},t.prototype.reverse=function(){return this.toCollection().reverse()},t.prototype.mapToClass=function(t){this.schema.mappedClass=t;var n=function(n){if(!n)return n;var r=Object.create(t.prototype);for(var i in n)if(f(n,i))try{r[i]=n[i]}catch(o){}return r};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=n,this.hook("reading",n),t},t.prototype.defineClass=function(){return this.mapToClass(function(t){c(this,t)})},t.prototype.add=function(t,n){var r=this,i=this.schema.primKey,o=i.auto,a=i.keyPath,s=t;return a&&o&&(s=tv(a)(t)),this._trans("readwrite",function(t){return r.core.mutate({trans:t,type:"add",keys:null!=n?[n]:null,values:[s]})}).then(function(t){return t.numFailures?eF.reject(t.failures[0]):t.lastResult}).then(function(n){if(a)try{I(t,a,n)}catch(r){}return n})},t.prototype.update=function(t,n){if("object"!=typeof n||s(n))throw new eo.InvalidArgument("Modifications must be an object.");if("object"!=typeof t||s(t))return this.where(":id").equals(t).modify(n);a(n).forEach(function(r){I(t,r,n[r])});var r=_(t,this.schema.primKey.keyPath);return void 0===r?tu(new eo.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(r).modify(n)},t.prototype.put=function(t,n){var r=this,i=this.schema.primKey,o=i.auto,a=i.keyPath,s=t;return a&&o&&(s=tv(a)(t)),this._trans("readwrite",function(t){return r.core.mutate({trans:t,type:"put",values:[s],keys:null!=n?[n]:null})}).then(function(t){return t.numFailures?eF.reject(t.failures[0]):t.lastResult}).then(function(n){if(a)try{I(t,a,n)}catch(r){}return n})},t.prototype.delete=function(t){var n=this;return this._trans("readwrite",function(r){return n.core.mutate({trans:r,type:"delete",keys:[t]})}).then(function(t){return t.numFailures?eF.reject(t.failures[0]):void 0})},t.prototype.clear=function(){var t=this;return this._trans("readwrite",function(n){return t.core.mutate({trans:n,type:"deleteRange",range:tg})}).then(function(t){return t.numFailures?eF.reject(t.failures[0]):void 0})},t.prototype.bulkGet=function(t){var n=this;return this._trans("readonly",function(r){return n.core.getMany({keys:t,trans:r}).then(function(t){return t.map(function(t){return n.hook.reading.fire(t)})})})},t.prototype.bulkAdd=function(t,n,r){var i=this,o=Array.isArray(n)?n:void 0,a=(r=r||(o?void 0:n))?r.allKeys:void 0;return this._trans("readwrite",function(n){var r=i.schema.primKey,s=r.auto,u=r.keyPath;if(u&&o)throw new eo.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(o&&o.length!==t.length)throw new eo.InvalidArgument("Arguments objects and keys must have the same length");var c=t.length,l=u&&s?t.map(tv(u)):t;return i.core.mutate({trans:n,type:"add",keys:o,values:l,wantResults:a}).then(function(t){var n=t.numFailures,r=t.results,o=t.lastResult,s=t.failures;if(0===n)return a?r:o;throw new en(i.name+".bulkAdd(): "+n+" of "+c+" operations failed",Object.keys(s).map(function(t){return s[t]}))})})},t.prototype.bulkPut=function(t,n,r){var i=this,o=Array.isArray(n)?n:void 0,a=(r=r||(o?void 0:n))?r.allKeys:void 0;return this._trans("readwrite",function(n){var r=i.schema.primKey,s=r.auto,u=r.keyPath;if(u&&o)throw new eo.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(o&&o.length!==t.length)throw new eo.InvalidArgument("Arguments objects and keys must have the same length");var c=t.length,l=u&&s?t.map(tv(u)):t;return i.core.mutate({trans:n,type:"put",keys:o,values:l,wantResults:a}).then(function(t){var n=t.numFailures,r=t.results,o=t.lastResult,s=t.failures;if(0===n)return a?r:o;throw new en(i.name+".bulkPut(): "+n+" of "+c+" operations failed",Object.keys(s).map(function(t){return s[t]}))})})},t.prototype.bulkDelete=function(t){var n=this,r=t.length;return this._trans("readwrite",function(r){return n.core.mutate({trans:r,type:"delete",keys:t})}).then(function(t){var i=t.numFailures,o=t.lastResult,a=t.failures;if(0===i)return o;throw new en(n.name+".bulkDelete(): "+i+" of "+r+" operations failed",a)})},t}();function tb(t){var n={},r=function(r,i){if(i){for(var o=arguments.length,a=Array(o-1);--o;)a[o-1]=arguments[o];return n[r].subscribe.apply(null,a),t}if("string"==typeof r)return n[r]};r.addEventType=u;for(var i=1,o=arguments.length;i<o;++i)u(arguments[i]);return r;function u(t,i,o){if("object"==typeof t)return function t(n){a(n).forEach(function(t){var r=n[t];if(s(r))u(t,n[t][0],n[t][1]);else{if("asap"!==r)throw new eo.InvalidArgument("Invalid event config");var i=u(t,ec,function(){for(var t=arguments.length,n=Array(t);t--;)n[t]=arguments[t];i.subscribers.forEach(function(t){C(function(){t.apply(null,n)})})})}})}(t);i||(i=ey),o||(o=eu);var c={subscribers:[],fire:o,subscribe:function(t){-1===c.subscribers.indexOf(t)&&(c.subscribers.push(t),c.fire=i(c.fire,t))},unsubscribe:function(t){c.subscribers=c.subscribers.filter(function(n){return n!==t}),c.fire=c.subscribers.reduce(i,o)}};return n[t]=r[t]=c,c}}function t$(t,n){return g(n).from({prototype:t}),n}function tw(t,n){return!(t.filter||t.algorithm||t.or)&&(n?t.justLimit:!t.replayFilter)}function t8(t,n){t.filter=ty(t.filter,n)}function tk(t,n,r){var i=t.replayFilter;t.replayFilter=i?function(){return ty(i(),n())}:n,t.justLimit=r&&!i}function tC(t,n){if(t.isPrimKey)return n.primaryKey;var r=n.getIndexByKeyPath(t.index);if(!r)throw new eo.Schema("KeyPath "+t.index+" on object store "+n.name+" is not indexed");return r}function tx(t,n,r){var i=tC(t,n.schema);return n.openCursor({trans:r,values:!t.keysOnly,reverse:"prev"===t.dir,unique:!!t.unique,query:{index:i,range:t.range}})}function t_(t,n,r,i){var o=t.replayFilter?ty(t.filter,t.replayFilter()):t.filter;if(t.or){var a={},s=function(t,r,i){if(!o||o(r,i,function(t){return r.stop(t)},function(t){return r.fail(t)})){var s=r.primaryKey,u=""+s;"[object ArrayBuffer]"===u&&(u=""+new Uint8Array(s)),f(a,u)||(a[u]=!0,n(t,r,i))}};return Promise.all([t.or._iterate(s,r),tI(tx(t,i,r),t.algorithm,s,!t.keysOnly&&t.valueMapper)])}return tI(tx(t,i,r),ty(t.algorithm,o),n,!t.keysOnly&&t.valueMapper)}function tI(t,n,r,i){var o=e4(i?function(t,n,o){return r(i(t),n,o)}:r);return t.then(function(t){if(t)return t.start(function(){var r=function(){return t.continue()};n&&!n(t,function(t){return r=t},function(n){t.stop(n),r=eu},function(n){t.fail(n),r=eu})||o(t.value,t,function(t){return r=t}),r()})})}var tS=function(){function t(){}return t.prototype._read=function(t,n){var r=this._ctx;return r.error?r.table._trans(null,tu.bind(null,r.error)):r.table._trans("readonly",t).then(n)},t.prototype._write=function(t){var n=this._ctx;return n.error?n.table._trans(null,tu.bind(null,n.error)):n.table._trans("readwrite",t,"locked")},t.prototype._addAlgorithm=function(t){var n=this._ctx;n.algorithm=ty(n.algorithm,t)},t.prototype._iterate=function(t,n){return t_(this._ctx,t,n,this._ctx.table.core)},t.prototype.clone=function(t){var n=Object.create(this.constructor.prototype),r=Object.create(this._ctx);return t&&c(r,t),n._ctx=r,n},t.prototype.raw=function(){return this._ctx.valueMapper=null,this},t.prototype.each=function(t){var n=this._ctx;return this._read(function(r){return t_(n,t,r,n.table.core)})},t.prototype.count=function(t){var n=this;return this._read(function(t){var r=n._ctx,i=r.table.core;if(tw(r,!0))return i.count({trans:t,query:{index:tC(r,i.schema),range:r.range}}).then(function(t){return Math.min(t,r.limit)});var o=0;return t_(r,function(){return++o,!1},t,i).then(function(){return o})}).then(t)},t.prototype.sortBy=function(t,n){var r=t.split(".").reverse(),i=r[0],o=r.length-1;function a(t,n){return n?a(t[r[n]],n-1):t[i]}var s="next"===this._ctx.dir?1:-1;function u(t,n){var r=a(t,o),i=a(n,o);return r<i?-s:r>i?s:0}return this.toArray(function(t){return t.sort(u)}).then(n)},t.prototype.toArray=function(t){var n=this;return this._read(function(t){var r=n._ctx;if("next"===r.dir&&tw(r,!0)&&r.limit>0){var i=r.valueMapper,o=tC(r,r.table.core.schema);return r.table.core.query({trans:t,limit:r.limit,values:!0,query:{index:o,range:r.range}}).then(function(t){var n=t.result;return i?n.map(i):n})}var a=[];return t_(r,function(t){return a.push(t)},t,r.table.core).then(function(){return a})},t)},t.prototype.offset=function(t){var n=this._ctx;return t<=0||(n.offset+=t,tw(n)?tk(n,function(){var n=t;return function(t,r){return 0===n||(1===n?(--n,!1):(r(function(){t.advance(n),n=0}),!1))}}):tk(n,function(){var n=t;return function(){return--n<0}})),this},t.prototype.limit=function(t){return this._ctx.limit=Math.min(this._ctx.limit,t),tk(this._ctx,function(){var n=t;return function(t,r,i){return--n<=0&&r(i),n>=0}},!0),this},t.prototype.until=function(t,n){return t8(this._ctx,function(r,i,o){return!t(r.value)||(i(o),n)}),this},t.prototype.first=function(t){return this.limit(1).toArray(function(t){return t[0]}).then(t)},t.prototype.last=function(t){return this.reverse().first(t)},t.prototype.filter=function(t){var n,r;return t8(this._ctx,function(n){return t(n.value)}),n=this._ctx,r=t,n.isMatch=ty(n.isMatch,r),this},t.prototype.and=function(t){return this.filter(t)},t.prototype.or=function(t){return new this.db.WhereClause(this._ctx.table,t,this)},t.prototype.reverse=function(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},t.prototype.desc=function(){return this.reverse()},t.prototype.eachKey=function(t){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(n,r){t(r.key,r)})},t.prototype.eachUniqueKey=function(t){return this._ctx.unique="unique",this.eachKey(t)},t.prototype.eachPrimaryKey=function(t){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(n,r){t(r.primaryKey,r)})},t.prototype.keys=function(t){var n=this._ctx;n.keysOnly=!n.isMatch;var r=[];return this.each(function(t,n){r.push(n.key)}).then(function(){return r}).then(t)},t.prototype.primaryKeys=function(t){var n=this._ctx;if("next"===n.dir&&tw(n,!0)&&n.limit>0)return this._read(function(t){var r=tC(n,n.table.core.schema);return n.table.core.query({trans:t,values:!1,limit:n.limit,query:{index:r,range:n.range}})}).then(function(t){return t.result}).then(t);n.keysOnly=!n.isMatch;var r=[];return this.each(function(t,n){r.push(n.primaryKey)}).then(function(){return r}).then(t)},t.prototype.uniqueKeys=function(t){return this._ctx.unique="unique",this.keys(t)},t.prototype.firstKey=function(t){return this.limit(1).keys(function(t){return t[0]}).then(t)},t.prototype.lastKey=function(t){return this.reverse().firstKey(t)},t.prototype.distinct=function(){var t=this._ctx,n=t.index&&t.table.schema.idxByName[t.index];if(!n||!n.multi)return this;var r={};return t8(this._ctx,function(t){var n=t.primaryKey.toString(),i=f(r,n);return r[n]=!0,!i}),this},t.prototype.modify=function(t){var n=this,r=this._ctx;return this._write(function(i){if("function"==typeof t)o=t;else{var o,s=a(t),u=s.length;o=function(n){for(var r=!1,i=0;i<u;++i){var o=s[i],a=t[o];_(n,o)!==a&&(I(n,o,a),r=!0)}return r}}var c=r.table.core,l=c.schema.primaryKey,d=l.outbound,f=l.extractKey,h="testmode"in no?1:2e3,p=n.db.core.cmp,y=[],g=0,v=[],m=function(t,n){var r=n.failures;g+=t-n.numFailures;for(var i=0,o=a(r);i<o.length;i++){var s=o[i];y.push(r[s])}};return n.clone().primaryKeys().then(function(t){var n=function(r){var a=Math.min(h,t.length-r);return c.getMany({trans:i,keys:t.slice(r,r+a)}).then(function(s){for(var u=[],l=[],y=d?[]:null,g=[],v=0;v<a;++v){var b=s[v],$={value:K(b),primKey:t[r+v]};!1!==o.call($,$.value,$)&&(null==$.value?g.push(t[r+v]):d||0===p(f(b),f($.value))?(l.push($.value),d&&y.push(t[r+v])):(g.push(t[r+v]),u.push($.value)))}return Promise.resolve(u.length>0&&c.mutate({trans:i,type:"add",values:u}).then(function(t){for(var n in t.failures)g.splice(parseInt(n),1);m(u.length,t)})).then(function(t){return l.length>0&&c.mutate({trans:i,type:"put",keys:y,values:l}).then(function(t){return m(l.length,t)})}).then(function(){return g.length>0&&c.mutate({trans:i,type:"delete",keys:g}).then(function(t){return m(g.length,t)})}).then(function(){return t.length>r+a&&n(r+h)})})};return n(0).then(function(){if(y.length>0)throw new et("Error modifying one or more objects",y,g,v);return t.length})})})},t.prototype.delete=function(){var t=this._ctx,n=t.range;return tw(t)&&(t.isPrimKey&&!th||3===n.type)?this._write(function(r){var i=t.table.core.schema.primaryKey,o=n;return t.table.core.count({trans:r,query:{index:i,range:o}}).then(function(n){return t.table.core.mutate({trans:r,type:"deleteRange",range:o}).then(function(t){var r=t.failures,i=(t.lastResult,t.results,t.numFailures);if(i)throw new et("Could not delete some values",Object.keys(r).map(function(t){return r[t]}),n-i);return n-i})})}):this.modify(function(t,n){return n.value=null})},t}();function tP(t,n){return t<n?-1:t===n?0:1}function tT(t,n){return t>n?-1:t===n?0:1}function tE(t,n,r){var i=t instanceof tV?new t.Collection(t):t;return i._ctx.error=r?new r(n):TypeError(n),i}function tD(t){return new t.Collection(t,function(){return tB("")}).limit(0)}function tA(t,n,r,i,o,a){for(var s=Math.min(t.length,i.length),u=-1,c=0;c<s;++c){var l=n[c];if(l!==i[c])return 0>o(t[c],r[c])?t.substr(0,c)+r[c]+r.substr(c+1):0>o(t[c],i[c])?t.substr(0,c)+i[c]+r.substr(c+1):u>=0?t.substr(0,u)+n[u]+r.substr(u+1):null;0>o(t[c],l)&&(u=c)}return s<i.length&&"next"===a?t+r.substr(t.length):s<t.length&&"prev"===a?t.substr(0,r.length):u<0?null:t.substr(0,u)+i[u]+r.substr(u+1)}function tO(t,n,r,i){var o,a,s,u,c,l,d,f=r.length;if(!r.every(function(t){return"string"==typeof t}))return tE(t,"String expected.");function h(t){o="next"===(n=t)?function(t){return t.toUpperCase()}:function(t){return t.toLowerCase()},a="next"===(f=t)?function(t){return t.toLowerCase()}:function(t){return t.toUpperCase()},s="next"===t?tP:tT;var n,f,h=r.map(function(t){return{lower:a(t),upper:o(t)}}).sort(function(t,n){return s(t.lower,n.lower)});u=h.map(function(t){return t.upper}),c=h.map(function(t){return t.lower}),l=t,d="next"===t?"":i}h("next");var p=new t.Collection(t,function(){return tK(u[0],c[f-1]+i)});p._ondirectionchange=function(t){h(t)};var y=0;return p._addAlgorithm(function(t,r,i){var o=t.key;if("string"!=typeof o)return!1;var h=a(o);if(n(h,c,y))return!0;for(var p=null,g=y;g<f;++g){var v=tA(o,h,u[g],c[g],s,l);null===v&&null===p?y=g+1:(null===p||s(p,v)>0)&&(p=v)}return r(null!==p?function(){t.continue(p+d)}:i),!1}),p}function tK(t,n,r,i){return{type:2,lower:t,upper:n,lowerOpen:r,upperOpen:i}}function tB(t){return{type:1,lower:t,upper:t}}var tV=function(){function t(){}return Object.defineProperty(t.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!0,configurable:!0}),t.prototype.between=function(t,n,r,i){r=!1!==r,i=!0===i;try{return this._cmp(t,n)>0||0===this._cmp(t,n)&&(r||i)&&(!r||!i)?tD(this):new this.Collection(this,function(){return tK(t,n,!r,!i)})}catch(o){return tE(this,tc)}},t.prototype.equals=function(t){return null==t?tE(this,tc):new this.Collection(this,function(){return tB(t)})},t.prototype.above=function(t){return null==t?tE(this,tc):new this.Collection(this,function(){return tK(t,void 0,!0)})},t.prototype.aboveOrEqual=function(t){return null==t?tE(this,tc):new this.Collection(this,function(){return tK(t,void 0,!1)})},t.prototype.below=function(t){return null==t?tE(this,tc):new this.Collection(this,function(){return tK(void 0,t,!1,!0)})},t.prototype.belowOrEqual=function(t){return null==t?tE(this,tc):new this.Collection(this,function(){return tK(void 0,t)})},t.prototype.startsWith=function(t){return"string"!=typeof t?tE(this,"String expected."):this.between(t,t+"ï¿¿",!0,!0)},t.prototype.startsWithIgnoreCase=function(t){return""===t?this.startsWith(t):tO(this,function(t,n){return 0===t.indexOf(n[0])},[t],"ï¿¿")},t.prototype.equalsIgnoreCase=function(t){return tO(this,function(t,n){return t===n[0]},[t],"")},t.prototype.anyOfIgnoreCase=function(){var t=U.apply(N,arguments);return 0===t.length?tD(this):tO(this,function(t,n){return -1!==n.indexOf(t)},t,"")},t.prototype.startsWithAnyOfIgnoreCase=function(){var t=U.apply(N,arguments);return 0===t.length?tD(this):tO(this,function(t,n){return n.some(function(n){return 0===t.indexOf(n)})},t,"ï¿¿")},t.prototype.anyOf=function(){var t=this,n=U.apply(N,arguments),r=this._cmp;try{n.sort(r)}catch(i){return tE(this,tc)}if(0===n.length)return tD(this);var o=new this.Collection(this,function(){return tK(n[0],n[n.length-1])});o._ondirectionchange=function(i){r="next"===i?t._ascending:t._descending,n.sort(r)};var a=0;return o._addAlgorithm(function(t,i,o){for(var s=t.key;r(s,n[a])>0;)if(++a===n.length)return i(o),!1;return 0===r(s,n[a])||(i(function(){t.continue(n[a])}),!1)}),o},t.prototype.notEqual=function(t){return this.inAnyRange([[-1/0,t],[t,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},t.prototype.noneOf=function(){var t=U.apply(N,arguments);if(0===t.length)return new this.Collection(this);try{t.sort(this._ascending)}catch(n){return tE(this,tc)}var r=t.reduce(function(t,n){return t?t.concat([[t[t.length-1][1],n]]):[[-1/0,n]]},null);return r.push([t[t.length-1],this.db._maxKey]),this.inAnyRange(r,{includeLowers:!1,includeUppers:!1})},t.prototype.inAnyRange=function(t,n){var r=this,i=this._cmp,o=this._ascending,a=this._descending,s=this._min,u=this._max;if(0===t.length)return tD(this);if(!t.every(function(t){return void 0!==t[0]&&void 0!==t[1]&&0>=o(t[0],t[1])}))return tE(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",eo.InvalidArgument);var c,l=!n||!1!==n.includeLowers,d=n&&!0===n.includeUppers,f=o;function h(t,n){return f(t[0],n[0])}try{(c=t.reduce(function(t,n){for(var r=0,o=t.length;r<o;++r){var a=t[r];if(0>i(n[0],a[1])&&i(n[1],a[0])>0){a[0]=s(a[0],n[0]),a[1]=u(a[1],n[1]);break}}return r===o&&t.push(n),t},[])).sort(h)}catch(p){return tE(this,tc)}var y=0,g=d?function(t){return o(t,c[y][1])>0}:function(t){return o(t,c[y][1])>=0},v=l?function(t){return a(t,c[y][0])>0}:function(t){return a(t,c[y][0])>=0},m=g,b=new this.Collection(this,function(){return tK(c[0][0],c[c.length-1][1],!l,!d)});return b._ondirectionchange=function(t){"next"===t?(m=g,f=o):(m=v,f=a),c.sort(h)},b._addAlgorithm(function(t,n,i){for(var a,s=t.key;m(s);)if(++y===c.length)return n(i),!1;return!(g(a=s)||v(a))||(0===r._cmp(s,c[y][1])||0===r._cmp(s,c[y][0])||n(function(){f===o?t.continue(c[y][0]):t.continue(c[y][1])}),!1)}),b},t.prototype.startsWithAnyOf=function(){var t=U.apply(N,arguments);return t.every(function(t){return"string"==typeof t})?0===t.length?tD(this):this.inAnyRange(t.map(function(t){return[t,t+"ï¿¿"]})):tE(this,"startsWithAnyOf() only works with strings")},t}();function tM(t){return 1===t.length?t[0]:t}function tF(t){try{return t.only([[]]),[[]]}catch(n){return"ï¿¿"}}function tq(t){return e4(function(n){return tj(n),t(n.target.error),!1})}function tj(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault()}var tN=function(){function t(){}return t.prototype._lock=function(){return k(!eK.global),++this._reculock,1!==this._reculock||eK.global||(eK.lockOwnerFor=this),this},t.prototype._unlock=function(){if(k(!eK.global),0==--this._reculock)for(eK.global||(eK.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var t=this._blockedFuncs.shift();try{tr(t[1],t[0])}catch(n){}}return this},t.prototype._locked=function(){return this._reculock&&eK.lockOwnerFor!==this},t.prototype.create=function(t){var n=this;if(!this.mode)return this;var r=this.db.idbdb,i=this.db._state.dbOpenError;if(k(!this.idbtrans),!t&&!r)switch(i&&i.name){case"DatabaseClosedError":throw new eo.DatabaseClosed(i);case"MissingAPIError":throw new eo.MissingAPI(i.message,i);default:throw new eo.OpenFailed(i)}if(!this.active)throw new eo.TransactionInactive;return k(null===this._completion._state),(t=this.idbtrans=t||r.transaction(tM(this.storeNames),this.mode)).onerror=e4(function(r){tj(r),n._reject(t.error)}),t.onabort=e4(function(r){tj(r),n.active&&n._reject(new eo.Abort(t.error)),n.active=!1,n.on("abort").fire(r)}),t.oncomplete=e4(function(){n.active=!1,n._resolve()}),this},t.prototype._promise=function(t,n,r){var i=this;if("readwrite"===t&&"readwrite"!==this.mode)return tu(new eo.ReadOnly("Transaction is readonly"));if(!this.active)return tu(new eo.TransactionInactive);if(this._locked())return new eF(function(o,a){i._blockedFuncs.push([function(){i._promise(t,n,r).then(o,a)},eK])});if(r)return eQ(function(){var t=new eF(function(t,r){i._lock();var o=n(t,r,i);o&&o.then&&o.then(t,r)});return t.finally(function(){return i._unlock()}),t._lib=!0,t});var o=new eF(function(t,r){var o=n(t,r,i);o&&o.then&&o.then(t,r)});return o._lib=!0,o},t.prototype._root=function(){return this.parent?this.parent._root():this},t.prototype.waitFor=function(t){var n=this._root(),r=eF.resolve(t);if(n._waitingFor)n._waitingFor=n._waitingFor.then(function(){return r});else{n._waitingFor=r,n._waitingQueue=[];var i=n.idbtrans.objectStore(n.storeNames[0]);!function t(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(i.get(-1/0).onsuccess=t)}()}var o=n._waitingFor;return new eF(function(t,i){r.then(function(r){return n._waitingQueue.push(e4(t.bind(null,r)))},function(t){return n._waitingQueue.push(e4(i.bind(null,t)))}).finally(function(){n._waitingFor===o&&(n._waitingFor=null)})})},t.prototype.abort=function(){this.active&&this._reject(new eo.Abort),this.active=!1},t.prototype.table=function(t){var n=this._memoizedTables||(this._memoizedTables={});if(f(n,t))return n[t];var r=this.schema[t];if(!r)throw new eo.NotFound("Table "+t+" not part of transaction");var i=new this.db.Table(t,r,this);return i.core=this.db.core.table(t),n[t]=i,i},t}();function tU(t,n,r,i,o,a,s){return{name:t,keyPath:n,unique:r,multi:i,auto:o,compound:a,src:(r&&!s?"&":"")+(i?"*":"")+(o?"++":"")+tR(n)}}function tR(t){return"string"==typeof t?t:t?"["+[].join.call(t,"+")+"]":""}function tW(t,n,r){return{name:t,primKey:n,indexes:r,mappedClass:null,idxByName:x(r,function(t){return[t.name,t]})}}function tL(t){var n;return null==t?function(){}:"string"==typeof t?1===(n=t).split(".").length?function(t){return t[n]}:function(t){return _(t,n)}:function(n){return _(n,t)}}function t0(t,n){return"delete"===n.type?n.keys:n.keys||n.values.map(t.extractKey)}function tH(t){return[].slice.call(t)}var t2=0;function t3(t){return null==t?":id":"string"==typeof t?t:"["+t.join("+")+"]"}function t1(t,n){var r,a,u,c,l,d,f,h=n.db,p=(r=t._middlewares,a=h,u=t._deps,c=n,l=u.IDBKeyRange,{dbcore:(d=function t(n,r,i,a){var u=r.cmp.bind(r);function c(t){if(3===t.type)return null;if(4===t.type)throw Error("Cannot convert never type to IDBKeyRange");var n=t.lower,r=t.upper,o=t.lowerOpen,a=t.upperOpen;return void 0===n?void 0===r?null:i.upperBound(r,!!a):void 0===r?i.lowerBound(n,!!o):i.bound(n,r,!!o,!!a)}var l,d,f,h=(l=n,d=a,f=tH(l.objectStoreNames),{schema:{name:l.name,tables:f.map(function(t){return d.objectStore(t)}).map(function(t){var n=t.keyPath,r=t.autoIncrement,i=s(n),o={},a={name:t.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:null==n,compound:i,keyPath:n,autoIncrement:r,unique:!0,extractKey:tL(n)},indexes:tH(t.indexNames).map(function(n){return t.index(n)}).map(function(t){var n=t.name,r=t.unique,i=t.multiEntry,a=t.keyPath,u={name:n,compound:s(a),keyPath:a,unique:r,multiEntry:i,extractKey:tL(a)};return o[t3(a)]=u,u}),getIndexByKeyPath:function(t){return o[t3(t)]}};return o[":id"]=a.primaryKey,null!=n&&(o[t3(n)]=a.primaryKey),a})},hasGetAll:f.length>0&&"getAll"in d.objectStore(f[0])&&!("undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),p=h.schema,y=h.hasGetAll,g=p.tables.map(function(t){var n,r,i;return{name:r=(n=t).name,schema:n,mutate:function(t){var i=t.trans,a=t.type,s=t.keys,u=t.values,l=t.range,d=t.wantResults;return new Promise(function(t,f){t=e4(t);var h=i.objectStore(r),p=null==h.keyPath,y="put"===a||"add"===a;if(!y&&"delete"!==a&&"deleteRange"!==a)throw Error("Invalid operation type: "+a);var g=(s||u||{length:1}).length;if(s&&u&&s.length!==u.length)throw Error("Given keys array must have same length as given values array.");if(0===g)return t({numFailures:0,failures:{},results:[],lastResult:void 0});var v,m=d&&o(s||t0(n.primaryKey,{type:a,keys:s,values:u})),b=[],$=0,w=function(t){++$,tj(t),m&&(m[t.target._reqno]=void 0),b[t.target._reqno]=t.target.error},k=function(t){var n=t.target;m[n._reqno]=n.result};if("deleteRange"===a){if(4===l.type)return t({numFailures:$,failures:b,results:m,lastResult:void 0});v=3===l.type?h.clear():h.delete(c(l))}else{var C=y?p?[u,s]:[u,null]:[s,null],x=C[0],_=C[1];if(y)for(var I=0;I<g;++I)(v=_&&void 0!==_[I]?h[a](x[I],_[I]):h[a](x[I]))._reqno=I,m&&void 0===m[I]&&(v.onsuccess=k),v.onerror=w;else for(I=0;I<g;++I)(v=h[a](x[I]))._reqno=I,v.onerror=w}var S=function(n){var r=n.target.result;m&&(m[g-1]=r),t({numFailures:$,failures:b,results:m,lastResult:r})};v.onerror=function(t){w(t),S(t)},v.onsuccess=S})},getMany:function(t){var n=t.trans,i=t.keys;return new Promise(function(t,o){t=e4(t);for(var a,s=n.objectStore(r),u=i.length,c=Array(u),l=0,d=0,f=function(n){var r=n.target;c[r._pos]=r.result,++d===l&&t(c)},h=tq(o),p=0;p<u;++p)null!=i[p]&&((a=s.get(i[p]))._pos=p,a.onsuccess=f,a.onerror=h,++l);0===l&&t(c)})},get:function(t){var n=t.trans,i=t.key;return new Promise(function(t,o){t=e4(t);var a=n.objectStore(r).get(i);a.onsuccess=function(n){return t(n.target.result)},a.onerror=tq(o)})},query:(i=y,function(t){return new Promise(function(n,o){n=e4(n);var a=t.trans,s=t.values,u=t.limit,l=t.query,d=u===1/0?void 0:u,f=l.index,h=l.range,p=a.objectStore(r),y=f.isPrimaryKey?p:p.index(f.name),g=c(h);if(0===u)return n({result:[]});if(i){var v=s?y.getAll(g,d):y.getAllKeys(g,d);v.onsuccess=function(t){return n({result:t.target.result})},v.onerror=tq(o)}else{var m=0,b=!s&&"openKeyCursor"in y?y.openKeyCursor(g):y.openCursor(g),$=[];b.onsuccess=function(t){var r=b.result;return r?($.push(s?r.value:r.primaryKey),++m===u?n({result:$}):void r.continue()):n({result:$})},b.onerror=tq(o)}})}),openCursor:function(t){var n=t.trans,i=t.values,o=t.query,a=t.reverse,s=t.unique;return new Promise(function(t,u){t=e4(t);var l=o.index,d=o.range,f=n.objectStore(r),h=l.isPrimaryKey?f:f.index(l.name),p=a?s?"prevunique":"prev":s?"nextunique":"next",y=!i&&"openKeyCursor"in h?h.openKeyCursor(c(d),p):h.openCursor(c(d),p);y.onerror=tq(u),y.onsuccess=e4(function(r){var i=y.result;if(i){i.___id=++t2,i.done=!1;var o=i.continue.bind(i),a=i.continuePrimaryKey;a&&(a=a.bind(i));var s=i.advance.bind(i),c=function(){throw Error("Cursor not stopped")};i.trans=n,i.stop=i.continue=i.continuePrimaryKey=i.advance=function(){throw Error("Cursor not started")},i.fail=e4(u),i.next=function(){var t=this,n=1;return this.start(function(){return n--?t.continue():t.stop()}).then(function(){return t})},i.start=function(t){var n=new Promise(function(t,n){t=e4(t),y.onerror=tq(n),i.fail=n,i.stop=function(n){i.stop=i.continue=i.continuePrimaryKey=i.advance=c,t(n)}}),r=function(){if(y.result)try{t()}catch(n){i.fail(n)}else i.done=!0,i.start=function(){throw Error("Cursor behind last entry")},i.stop()};return y.onsuccess=e4(function(t){y.onsuccess=r,r()}),i.continue=o,i.continuePrimaryKey=a,i.advance=s,r(),n},t(i)}else t(null)},u)})},count:function(t){var n=t.query,i=t.trans,o=n.index,a=n.range;return new Promise(function(t,n){var s=i.objectStore(r),u=o.isPrimaryKey?s:s.index(o.name),l=c(a),d=l?u.count(l):u.count();d.onsuccess=e4(function(n){return t(n.target.result)}),d.onerror=tq(n)})}}}),v={};return g.forEach(function(t){return v[t.name]=t}),{stack:"dbcore",transaction:n.transaction.bind(n),table:function(t){if(!v[t])throw Error("Table '"+t+"' not found");return v[t]},cmp:u,MIN_KEY:-1/0,MAX_KEY:tF(i),schema:p}}(a,u.indexedDB,l,c),(f=r.dbcore).reduce(function(t,n){var r=n.create;return i(i({},t),r(t))},d))});t.core=p.dbcore,t.tables.forEach(function(n){var r=n.name;t.core.schema.tables.some(function(t){return t.name===r})&&(n.core=t.core.table(r),t[r]instanceof t.Table&&(t[r].core=n.core))})}function t4(t,n,r,i){r.forEach(function(r){var o=i[r];n.forEach(function(n){var i=m(n,r);(!i||"value"in i&&void 0===i.value)&&(n===t.Transaction.prototype||n instanceof t.Transaction?y(n,r,{get:function(){return this.table(r)},set:function(t){p(this,r,{value:t,writable:!0,configurable:!0,enumerable:!0})}}):n[r]=new t.Table(r,o))})})}function tG(t,n){n.forEach(function(n){for(var r in n)n[r]instanceof t.Table&&delete n[r]})}function tz(t,n){return t._cfg.version-n._cfg.version}function t6(t,n){var r,i={del:[],add:[],change:[]};for(r in t)n[r]||i.del.push(r);for(r in n){var o=t[r],a=n[r];if(o){var s={name:r,def:a,recreate:!1,del:[],add:[],change:[]};if(""+(o.primKey.keyPath||"")==""+(a.primKey.keyPath||"")&&(o.primKey.auto===a.primKey.auto||td)){var u=o.idxByName,c=a.idxByName,l=void 0;for(l in u)c[l]||s.del.push(l);for(l in c){var d=u[l],f=c[l];d?d.src!==f.src&&s.change.push(f):s.add.push(f)}(s.del.length>0||s.add.length>0||s.change.length>0)&&i.change.push(s)}else s.recreate=!0,i.change.push(s)}else i.add.push([r,a])}return i}function t7(t,n,r,i){var o=t.db.createObjectStore(n,r.keyPath?{keyPath:r.keyPath,autoIncrement:r.auto}:{autoIncrement:r.auto});return i.forEach(function(t){return t9(o,t)}),o}function t9(t,n){t.createIndex(n.name,n.keyPath,{unique:n.unique,multiEntry:n.multi})}function tY(t,n,r){var i={};return $(n.objectStoreNames,0).forEach(function(t){for(var n=r.objectStore(t),o=n.keyPath,a=tU(tR(o),o||"",!1,!1,!!n.autoIncrement,o&&"string"!=typeof o,!0),s=[],u=0;u<n.indexNames.length;++u){var c=n.index(n.indexNames[u]);o=c.keyPath;var l=tU(c.name,o,!!c.unique,!!c.multiEntry,!1,o&&"string"!=typeof o,!1);s.push(l)}i[t]=tW(t,a,s)}),i}function tQ(t,n,r){for(var i=r.db.objectStoreNames,o=0;o<i.length;++o){var a=i[o],s=r.objectStore(a);t._hasGetAll="getAll"in s;for(var c=0;c<s.indexNames.length;++c){var l=s.indexNames[c],d=s.index(l).keyPath,f="string"==typeof d?d:"["+$(d).join("+")+"]";if(n[a]){var h=n[a].idxByName[f];h&&(h.name=l,delete n[a].idxByName[f],n[a].idxByName[l]=h)}}}"undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&u.WorkerGlobalScope&&u instanceof u.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(t._hasGetAll=!1)}var tJ,t5=function(){function t(){}return t.prototype._parseStoresSpec=function(t,n){a(t).forEach(function(r){if(null!==t[r]){var i=t[r].split(",").map(function(t,n){var r=(t=t.trim()).replace(/([&*]|\+\+)/g,""),i=/^\[/.test(r)?r.match(/^\[(.*)\]$/)[1].split("+"):r;return tU(r,i||null,/\&/.test(t),/\*/.test(t),/\+\+/.test(t),s(i),0===n)}),o=i.shift();if(o.multi)throw new eo.Schema("Primary key cannot be multi-valued");i.forEach(function(t){if(t.auto)throw new eo.Schema("Only primary key can be marked as autoIncrement (++)");if(!t.keyPath)throw new eo.Schema("Index must have a name and cannot be an empty string")}),n[r]=tW(r,o,i)}})},t.prototype.stores=function(t){var n=this.db;this._cfg.storesSource=this._cfg.storesSource?c(this._cfg.storesSource,t):t;var r=n._versions,i={},o={};return r.forEach(function(t){c(i,t._cfg.storesSource),o=t._cfg.dbschema={},t._parseStoresSpec(i,o)}),n._dbSchema=o,tG(n,[n._allTables,n,n.Transaction.prototype]),t4(n,[n._allTables,n,n.Transaction.prototype,this._cfg.tables],a(o),o),n._storeNames=a(o),this},t.prototype.upgrade=function(t){return this._cfg.contentUpgrade=t,this},t}();function tZ(t){return eQ(function(){return eK.letThrough=!0,t()})}function tX(t){var n=function(n){return t.next(n)},r=o(n),i=o(function(n){return t.throw(n)});function o(t){return function(n){var o=t(n),a=o.value;return o.done?a:a&&"function"==typeof a.then?a.then(r,i):s(a)?Promise.all(a).then(r,i):r(a)}}return o(n)()}function ne(t,n,r){var i=arguments.length;if(i<2)throw new eo.InvalidArgument("Too few arguments");for(var o=Array(i-1);--i;)o[i-1]=arguments[i];r=o.pop();var a=E(o);return[t,a,r]}function nt(t,n,r,i,o){return eF.resolve().then(function(){var a=eK.transless||eK,s=t._createTransaction(n,r,t._dbSchema,i);i?s.idbtrans=i.idbtrans:s.create();var u,c=R(o);c&&eJ();var l=eF.follow(function(){if(u=o.call(s,s)){if(c){var t=e5.bind(null,null);u.then(t,t)}else"function"==typeof u.next&&"function"==typeof u.throw&&(u=tX(u))}},{trans:s,transless:a});return(u&&"function"==typeof u.then?eF.resolve(u).then(function(t){return s.active?t:tu(new eo.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):l.then(function(){return u})).then(function(t){return i&&s._resolve(),s._completion.then(function(){return t})}).catch(function(t){return s._reject(t),tu(t)})})}function nn(t,n,r){for(var i=s(t)?t.slice():[t],o=0;o<r;++o)i.push(n);return i}var nr={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(t){return i(i({},t),{table:function(n){var r=t.table(n),o=r.schema,a={},s=[];function u(t,n,r){var o=t3(t),c=a[o]=a[o]||[],l=null==t?0:"string"==typeof t?1:t.length,d=n>0,f=i(i({},r),{isVirtual:d,isPrimaryKey:!d&&r.isPrimaryKey,keyTail:n,keyLength:l,extractKey:tL(t),unique:!d&&r.unique});return c.push(f),f.isPrimaryKey||s.push(f),l>1&&u(2===l?t[0]:t.slice(0,l-1),n+1,r),c.sort(function(t,n){return t.keyTail-n.keyTail}),f}var c=u(o.primaryKey.keyPath,0,o.primaryKey);a[":id"]=[c];for(var l=0,d=o.indexes;l<d.length;l++){var f=d[l];u(f.keyPath,0,f)}function h(n){var r,o,a=n.query.index;return a.isVirtual?i(i({},n),{query:{index:a,range:(r=n.query.range,o=a.keyTail,{type:1===r.type?2:r.type,lower:nn(r.lower,r.lowerOpen?t.MAX_KEY:t.MIN_KEY,o),lowerOpen:!0,upper:nn(r.upper,r.upperOpen?t.MIN_KEY:t.MAX_KEY,o),upperOpen:!0})}}):n}return i(i({},r),{schema:i(i({},o),{primaryKey:c,indexes:s,getIndexByKeyPath:function(t){var n=a[t3(t)];return n&&n[0]}}),count:function(t){return r.count(h(t))},query:function(t){return r.query(h(t))},openCursor:function(n){var i=n.query.index,o=i.keyTail,a=i.isVirtual,s=i.keyLength;return a?r.openCursor(h(n)).then(function(r){var i;return r&&Object.create(i=r,{continue:{value:function(r){null!=r?i.continue(nn(r,n.reverse?t.MAX_KEY:t.MIN_KEY,o)):n.unique?i.continue(nn(i.key,n.reverse?t.MIN_KEY:t.MAX_KEY,o)):i.continue()}},continuePrimaryKey:{value:function(n,r){i.continuePrimaryKey(nn(n,t.MAX_KEY,o),r)}},key:{get:function(){var t=i.key;return 1===s?t[0]:t.slice(0,s)}},value:{get:function(){return i.value}}})}):r.openCursor(n)}})}})}},ni={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(t){return i(i({},t),{table:function(n){var r=t.table(n),a=r.schema.primaryKey;return i(i({},r),{mutate:function(t){var s=eK.trans,u=s.table(n).hook,c=u.deleting,l=u.creating,d=u.updating;switch(t.type){case"add":if(l.fire===eu)break;return s._promise("readwrite",function(){return h(t)},!0);case"put":if(l.fire===eu&&d.fire===eu)break;return s._promise("readwrite",function(){return h(t)},!0);case"delete":if(c.fire===eu)break;return s._promise("readwrite",function(){return h(t)},!0);case"deleteRange":if(c.fire===eu)break;return s._promise("readwrite",function(){var n;return function t(n,o,s){return r.query({trans:n,values:!1,query:{index:a,range:o},limit:s}).then(function(r){var a=r.result;return h({type:"delete",keys:a,trans:n}).then(function(r){return r.numFailures>0?Promise.reject(r.failures[0]):a.length<s?{failures:[],numFailures:0,lastResult:void 0}:t(n,i(i({},o),{lower:a[a.length-1],lowerOpen:!0}),s)})})}((n=t).trans,n.range,1e4)},!0)}return r.mutate(t);function h(t){var n,s,u,h=eK.trans,p=t.keys||t0(a,t);if(!p)throw Error("Keys missing");return"delete"!==(t="add"===t.type||"put"===t.type?i(i({},t),{keys:p,wantResults:!0}):i({},t)).type&&(t.values=o(t.values)),t.keys&&(t.keys=o(t.keys)),(n=r,s=t,u=p,"add"===s.type?Promise.resolve(Array(s.values.length)):n.getMany({trans:s.trans,keys:u})).then(function(n){var i=p.map(function(r,i){var o=n[i],s={onerror:null,onsuccess:null};if("delete"===t.type)c.fire.call(s,r,o,h);else if("add"===t.type||void 0===o){var u=l.fire.call(s,r,t.values[i],h);null==r&&null!=u&&(r=u,t.keys[i]=r,a.outbound||I(t.values[i],a.keyPath,r))}else{var p=F(o,t.values[i]),y=d.fire.call(s,p,r,o,h);if(y){var g=t.values[i];Object.keys(y).forEach(function(t){f(g,t)?g[t]=y[t]:I(g,t,y[t])})}}return s});return r.mutate(t).then(function(r){for(var o=r.failures,a=r.results,s=r.numFailures,u=r.lastResult,c=0;c<p.length;++c){var l=a?a[c]:p[c],d=i[c];null==l?d.onerror&&d.onerror(o[c]):d.onsuccess&&d.onsuccess("put"===t.type&&n[c]?t.values[c]:l)}return{failures:o,results:a,numFailures:s,lastResult:u}}).catch(function(t){return i.forEach(function(n){return n.onerror&&n.onerror(t)}),Promise.reject(t)})})}}})}})}},no=function(){function t(n,r){var o=this;this._middlewares={},this.verno=0;var a=t.dependencies;this._options=r=i({addons:t.addons,autoOpen:!0,indexedDB:a.indexedDB,IDBKeyRange:a.IDBKeyRange},r),this._deps={indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange};var s=r.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null;var u,c,l,d,f,h,p,y={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:eu,dbReadyPromise:null,cancelOpen:eu,openCanceller:null,autoSchema:!0};y.dbReadyPromise=new eF(function(t){y.dbReadyResolve=t}),y.openCanceller=new eF(function(t,n){y.cancelOpen=n}),this._state=y,this.name=n,this.on=tb(this,"populate","blocked","versionchange",{ready:[eg,eu]}),this.on.ready.subscribe=(c=this.on.ready.subscribe,(l=function(n){return function(r,i){t.vip(function(){var t=o._state;if(t.openComplete)t.dbOpenError||eF.resolve().then(r),i&&n(r);else if(t.onReadyBeingFired)t.onReadyBeingFired.push(r),i&&n(r);else{n(r);var a=o;i||n(function t(){a.on.ready.unsubscribe(r),a.on.ready.unsubscribe(t)})}})}})(c)),this.Collection=(u=this,t$(tS.prototype,function(t,n){this.db=u;var r=tg,i=null;if(n)try{r=n()}catch(o){i=o}var a=t._ctx,s=a.table,c=s.hook.reading.fire;this._ctx={table:s,index:a.index,isPrimKey:!a.index||s.schema.primKey.keyPath&&a.index===s.schema.primKey.name,range:r,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:i,or:a.or,valueMapper:c!==ec?c:null}})),this.Table=(d=this,t$(tm.prototype,function(t,n,r){this.db=d,this._tx=r,this.name=t,this.schema=n,this.hook=d._allTables[t]?d._allTables[t].hook:tb(null,{creating:[ef,eu],reading:[el,ec],updating:[ep,eu],deleting:[eh,eu]})})),this.Transaction=(f=this,t$(tN.prototype,function(t,n,r,i){var o=this;this.db=f,this.mode=t,this.storeNames=n,this.schema=r,this.idbtrans=null,this.on=tb(this,"complete","error","abort"),this.parent=i||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new eF(function(t,n){o._resolve=t,o._reject=n}),this._completion.then(function(){o.active=!1,o.on.complete.fire()},function(t){var n=o.active;return o.active=!1,o.on.error.fire(t),o.parent?o.parent._reject(t):n&&o.idbtrans&&o.idbtrans.abort(),tu(t)})})),this.Version=(h=this,t$(t5.prototype,function(t){this.db=h,this._cfg={version:t,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(p=this,t$(tV.prototype,function(t,n,r){this.db=p,this._ctx={table:t,index:":id"===n?null:n,or:r};var i=p._deps.indexedDB;if(!i)throw new eo.MissingAPI("indexedDB API missing");this._cmp=this._ascending=i.cmp.bind(i),this._descending=function(t,n){return i.cmp(n,t)},this._max=function(t,n){return i.cmp(t,n)>0?t:n},this._min=function(t,n){return 0>i.cmp(t,n)?t:n},this._IDBKeyRange=p._deps.IDBKeyRange})),this.on("versionchange",function(t){t.newVersion>0?console.warn("Another connection wants to upgrade database '"+o.name+"'. Closing db now to resume the upgrade."):console.warn("Another connection wants to delete database '"+o.name+"'. Closing db now to resume the delete request."),o.close()}),this.on("blocked",function(t){!t.newVersion||t.newVersion<t.oldVersion?console.warn("Dexie.delete('"+o.name+"') was blocked"):console.warn("Upgrade '"+o.name+"' blocked by other connection holding version "+t.oldVersion/10)}),this._maxKey=tF(r.IDBKeyRange),this._createTransaction=function(t,n,r,i){return new o.Transaction(t,n,r,i)},this._fireOnBlocked=function(t){o.on("blocked").fire(t),tl.filter(function(t){return t.name===o.name&&t!==o&&!t._state.vcFired}).map(function(n){return n.on("versionchange").fire(t)})},this.use(nr),this.use(ni),s.forEach(function(t){return t(o)})}return t.prototype.version=function(t){if(isNaN(t)||t<.1)throw new eo.Type("Given version is not a positive number");if(t=Math.round(10*t)/10,this.idbdb||this._state.isBeingOpened)throw new eo.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,t);var n=this._versions,r=n.filter(function(n){return n._cfg.version===t})[0];return r||(r=new this.Version(t),n.push(r),n.sort(tz),r.stores({}),this._state.autoSchema=!1,r)},t.prototype._whenReady=function(t){var n=this;return this._state.openComplete||eK.letThrough?t():new eF(function(t,r){if(!n._state.isBeingOpened){if(!n._options.autoOpen)return void r(new eo.DatabaseClosed);n.open().catch(eu)}n._state.dbReadyPromise.then(t,r)}).then(t)},t.prototype.use=function(t){var n=t.stack,r=t.create,i=t.level,o=t.name;o&&this.unuse({stack:n,name:o});var a=this._middlewares[n]||(this._middlewares[n]=[]);return a.push({stack:n,create:r,level:null==i?10:i,name:o}),a.sort(function(t,n){return t.level-n.level}),this},t.prototype.unuse=function(t){var n=t.stack,r=t.name,i=t.create;return n&&this._middlewares[n]&&(this._middlewares[n]=this._middlewares[n].filter(function(t){return i?t.create!==i:!!r&&t.name!==r})),this},t.prototype.open=function(){return function t(n){var r=n._state,i=n._deps.indexedDB;if(r.isBeingOpened||n.idbdb)return r.dbReadyPromise.then(function(){return r.dbOpenError?tu(r.dbOpenError):n});W&&(r.openCanceller._stackHolder=z()),r.isBeingOpened=!0,r.dbOpenError=null,r.openComplete=!1;var o=r.dbReadyResolve,s=null;return eF.race([r.openCanceller,new eF(function(t,o){if(!i)throw new eo.MissingAPI("indexedDB API not found. If using IE10+, make sure to run your code on a server URL (not locally). If using old Safari versions, make sure to include indexedDB polyfill.");var u=n.name,c=r.autoSchema?i.open(u):i.open(u,Math.round(10*n.verno));if(!c)throw new eo.MissingAPI("IndexedDB API not available");c.onerror=tq(o),c.onblocked=e4(n._fireOnBlocked),c.onupgradeneeded=e4(function(t){if(s=c.transaction,r.autoSchema&&!n._options.allowEmptyDB){c.onerror=tj,s.abort(),c.result.close();var l=i.deleteDatabase(u);l.onsuccess=l.onerror=e4(function(){o(new eo.NoSuchDatabase("Database "+u+" doesnt exist"))})}else{s.onerror=tq(o);var d,f,h,p,y,g,v,m,b=t.oldVersion>0x4000000000000000?0:t.oldVersion;n.idbdb=c.result,d=n,f=b/10,h=s,p=o,y=d._dbSchema,(g=d._createTransaction("readwrite",d._storeNames,y)).create(h),g._completion.catch(p),v=g._reject.bind(g),m=eK.transless||eK,eQ(function(){var t,n,r,i,o,s,u,c;eK.trans=g,eK.transless=m,0===f?(a(y).forEach(function(t){t7(h,t,y[t].primKey,y[t].indexes)}),t1(d,h),eF.follow(function(){return d.on.populate.fire(g)}).catch(v)):(t=d,n=f,r=g,i=h,o=[],s=t._versions,u=t._dbSchema=tY(t,t.idbdb,i),c=!1,s.filter(function(t){return t._cfg.version>=n}).forEach(function(s){o.push(function(){var o=u,l=s._cfg.dbschema;tQ(t,o,i),tQ(t,l,i),u=t._dbSchema=l;var d=t6(o,l);d.add.forEach(function(t){t7(i,t[0],t[1].primKey,t[1].indexes)}),d.change.forEach(function(t){if(t.recreate)throw new eo.Upgrade("Not yet support for changing primary key");var n=i.objectStore(t.name);t.add.forEach(function(t){return t9(n,t)}),t.change.forEach(function(t){n.deleteIndex(t.name),t9(n,t)}),t.del.forEach(function(t){return n.deleteIndex(t)})});var f=s._cfg.contentUpgrade;if(f&&s._cfg.version>n){t1(t,i),r._memoizedTables={},c=!0;var h=P(l);d.del.forEach(function(t){h[t]=o[t]}),tG(t,[t.Transaction.prototype]),t4(t,[t.Transaction.prototype],a(h),h),r.schema=h;var p,y=R(f);y&&eJ();var g=eF.follow(function(){if((p=f(r))&&y){var t=e5.bind(null,null);p.then(t,t)}});return p&&"function"==typeof p.then?eF.resolve(p):g.then(function(){return p})}}),o.push(function(n){c&&tf||function(t,n){for(var r=0;r<n.db.objectStoreNames.length;++r){var i=n.db.objectStoreNames[r];null==t[i]&&n.db.deleteObjectStore(i)}}(s._cfg.dbschema,n),tG(t,[t.Transaction.prototype]),t4(t,[t.Transaction.prototype],t._storeNames,t._dbSchema),r.schema=t._dbSchema})}),(function t(){return o.length?eF.resolve(o.shift()(r.idbtrans)).then(t):eF.resolve()})().then(function(){var t,n;n=i,a(t=u).forEach(function(r){n.db.objectStoreNames.contains(r)||t7(n,r,t[r].primKey,t[r].indexes)})})).catch(v)})}},o),c.onsuccess=e4(function(){s=null;var i=n.idbdb=c.result,o=$(i.objectStoreNames);if(o.length>0)try{var l,d,f,h,p,y,g,v=i.transaction(tM(o),"readonly");r.autoSchema?(l=n,d=i,f=v,l.verno=d.version/10,h=l._dbSchema=tY(0,d,f),l._storeNames=$(d.objectStoreNames,0),t4(l,[l._allTables],a(h),h)):(tQ(n,n._dbSchema,v),p=n,y=v,((g=t6(tY(0,p.idbdb,y),p._dbSchema)).add.length||g.change.some(function(t){return t.add.length||t.change.length}))&&console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),t1(n,v)}catch(m){}tl.push(n),i.onversionchange=e4(function(t){r.vcFired=!0,n.on("versionchange").fire(t)}),tJ.add(u),t()},o)})]).then(function(){return r.onReadyBeingFired=[],eF.resolve(tZ(n.on.ready.fire)).then(function t(){if(r.onReadyBeingFired.length>0){var n=r.onReadyBeingFired.reduce(eg,eu);return r.onReadyBeingFired=[],eF.resolve(tZ(n)).then(t)}})}).finally(function(){r.onReadyBeingFired=null}).then(function(){return r.isBeingOpened=!1,n}).catch(function(t){try{s&&s.abort()}catch(i){}return r.isBeingOpened=!1,n.close(),r.dbOpenError=t,tu(r.dbOpenError)}).finally(function(){r.openComplete=!0,o()})}(this)},t.prototype.close=function(){var t=tl.indexOf(this),n=this._state;if(t>=0&&tl.splice(t,1),this.idbdb){try{this.idbdb.close()}catch(r){}this.idbdb=null}this._options.autoOpen=!1,n.dbOpenError=new eo.DatabaseClosed,n.isBeingOpened&&n.cancelOpen(n.dbOpenError),n.dbReadyPromise=new eF(function(t){n.dbReadyResolve=t}),n.openCanceller=new eF(function(t,r){n.cancelOpen=r})},t.prototype.delete=function(){var t=this,n=arguments.length>0,r=this._state;return new eF(function(i,o){var a=function(){t.close();var n=t._deps.indexedDB.deleteDatabase(t.name);n.onsuccess=e4(function(){tJ.remove(t.name),i()}),n.onerror=tq(o),n.onblocked=t._fireOnBlocked};if(n)throw new eo.InvalidArgument("Arguments not allowed in db.delete()");r.isBeingOpened?r.dbReadyPromise.then(a):a()})},t.prototype.backendDB=function(){return this.idbdb},t.prototype.isOpen=function(){return null!==this.idbdb},t.prototype.hasBeenClosed=function(){var t=this._state.dbOpenError;return t&&"DatabaseClosed"===t.name},t.prototype.hasFailed=function(){return null!==this._state.dbOpenError},t.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(t.prototype,"tables",{get:function(){var t=this;return a(this._allTables).map(function(n){return t._allTables[n]})},enumerable:!0,configurable:!0}),t.prototype.transaction=function(){var t=ne.apply(this,arguments);return this._transaction.apply(this,t)},t.prototype._transaction=function(t,n,r){var i=this,o=eK.trans;o&&o.db===this&&-1===t.indexOf("!")||(o=null);var a,s,u=-1!==t.indexOf("?");t=t.replace("!","").replace("?","");try{if(s=n.map(function(t){var n=t instanceof i.Table?t.name:t;if("string"!=typeof n)throw TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return n}),"r"==t||"readonly"===t)a="readonly";else{if("rw"!=t&&"readwrite"!=t)throw new eo.InvalidArgument("Invalid transaction mode: "+t);a="readwrite"}if(o){if("readonly"===o.mode&&"readwrite"===a){if(!u)throw new eo.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");o=null}o&&s.forEach(function(t){if(o&&-1===o.storeNames.indexOf(t)){if(!u)throw new eo.SubTransaction("Table "+t+" not included in parent transaction.");o=null}}),u&&o&&!o.active&&(o=null)}}catch(c){return o?o._promise(null,function(t,n){n(c)}):tu(c)}var l=nt.bind(null,this,a,s,o,r);return o?o._promise(a,l,"lock"):eK.trans?tr(eK.transless,function(){return i._whenReady(l)}):this._whenReady(l)},t.prototype.table=function(t){if(!f(this._allTables,t))throw new eo.InvalidTable("Table "+t+" does not exist");return this._allTables[t]},t}(),na=no;h(na,i(i({},es),{delete:function(t){return new na(t).delete()},exists:function(t){return new na(t,{addons:[]}).open().then(function(t){return t.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(t){return tJ?tJ.getDatabaseNames().then(t):eF.resolve([])},defineClass:function(){return function(t){c(this,t)}},ignoreTransaction:function(t){return eK.trans?tr(eK.transless,t):t()},vip:tZ,async:function(t){return function(){try{var n=tX(t.apply(this,arguments));return n&&"function"==typeof n.then?n:eF.resolve(n)}catch(r){return tu(r)}}},spawn:function(t,n,r){try{var i=tX(t.apply(r,n||[]));return i&&"function"==typeof i.then?i:eF.resolve(i)}catch(o){return tu(o)}},currentTransaction:{get:function(){return eK.trans||null}},waitFor:function(t,n){var r=eF.resolve("function"==typeof t?na.ignoreTransaction(t):t).timeout(n||6e4);return eK.trans?eK.trans.waitFor(r):r},Promise:eF,debug:{get:function(){return W},set:function(t){L(t,"dexie"===t?function(){return!0}:tp)}},derive:g,extend:c,props:h,override:w,Events:tb,getByKeyPath:_,setByKeyPath:I,delByKeyPath:S,shallowClone:P,deepClone:K,getObjectDiff:F,asap:C,minKey:-1/0,addons:[],connections:tl,errnames:er,dependencies:function(){try{return{indexedDB:u.indexedDB||u.mozIndexedDB||u.webkitIndexedDB||u.msIndexedDB,IDBKeyRange:u.IDBKeyRange||u.webkitIDBKeyRange}}catch(t){return{indexedDB:null,IDBKeyRange:null}}}(),semVer:"3.0.3",version:"3.0.3".split(".").map(function(t){return parseInt(t)}).reduce(function(t,n,r){return t+n/Math.pow(10,2*r)}),default:na,Dexie:na})),na.maxKey=tF(na.dependencies.IDBKeyRange),function(t){try{tJ=function(t){var n,r=t&&"function"==typeof t.databases;if(!r){var i=new no("__dbnames",{addons:[]});i.version(1).stores({dbnames:"name"}),n=i.table("dbnames")}return{getDatabaseNames:function(){return r?eF.resolve(t.databases()).then(function(t){return t.map(function(t){return t.name}).filter(function(t){return"__dbnames"!==t})}):n.toCollection().primaryKeys()},add:function(t){return!r&&"__dbnames"!==t&&n.put({name:t}).catch(eu)},remove:function(t){return!r&&"__dbnames"!==t&&n.delete(t).catch(eu)}}}(t)}catch(n){}}(no.dependencies.indexedDB),eF.rejectionMapper=function(t,n){if(!t||t instanceof X||t instanceof TypeError||t instanceof SyntaxError||!t.name||!ea[t.name])return t;var r=new ea[t.name](n||t.message,t);return"stack"in t&&y(r,"stack",{get:function(){return this.inner.stack}}),r},L(W,tp),n.default=no},function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=class{static debug(...t){console.debug(t)}static info(...t){console.info(t)}static error(...t){console.error(t)}static warn(...t){console.warn(t)}}},function(t,n,r){"use strict";var i=this&&this.__awaiter||function(t,n,r,i){return new(r||(r=Promise))(function(o,a){function s(t){try{c(i.next(t))}catch(n){a(n)}}function u(t){try{c(i.throw(t))}catch(n){a(n)}}function c(t){var n;t.done?o(t.value):((n=t.value)instanceof r?n:new r(function(t){t(n)})).then(s,u)}c((i=i.apply(t,n||[])).next())})};Object.defineProperty(n,"__esModule",{value:!0}),n.GrowPushManager=void 0;let o=r(0),a=r(5),s=r(6),u=r(13);n.GrowPushManager=class{constructor(t,n){this.initVars=t,this.swRegistration=n,this.initVars=t}init(){return i(this,void 0,void 0,function*(){if(this.db=yield o.DbManager.Instance(),this.initVars.pushOptInSetting.isEnabled&&(yield this.showConsentPopup())&&this.initVars.pushOptInSetting.isEnabled){let t=new s.PopupManager(this.initVars),n=yield t.show(this.initVars.pushOptInSetting.showModal);if(yield this.db.save(o.DbKeys.LastOptInAt,(new Date).getTime()/1e3),!n)return void(yield this.db.save(o.DbKeys.LastOptInAt,(new Date).getTime()/1e3));console.log("requesting prompt"),this.notificationStatus=yield this.requestNotificationPermission(),this.notificationStatus&&(yield this.saveSubscription())}})}saveSubscription(){return i(this,void 0,void 0,function*(){let t=yield this.createPushSubscription(),n=yield this.saveToServer(t);if(200===n.status){let r=yield n.json().then(t=>t.uniqueId),i=yield o.DbManager.Instance();return yield i.save(o.DbKeys.SubscriberId,r),yield i.save(o.DbKeys.ClientId,this.initVars.clientId),yield i.save(o.DbKeys.PushData,JSON.stringify(t.toJSON())),t}return null})}requestNotificationPermission(){return i(this,void 0,void 0,function*(){return"granted"===(yield Notification.requestPermission().catch(t=>(console.error(t,"Grow Notification Prompt"),Promise.reject(t))))})}showConsentPopup(){return i(this,void 0,void 0,function*(){if(void 0!==window.safari)return!1;let t=yield this.db.find(o.DbKeys.LastOptInAt),n=Number.parseInt((null==t?void 0:t.value)||"0");if(!Number.isNaN(n)&&(new Date).getTime()/1e3<n+(this.initVars.pushOptInSetting.delay||a.Constants.DefaultOptinTimeout))return!1;let r="granted"!==Notification.permission&&"denied"!==Notification.permission;if(!r){let i=yield this.swRegistration.pushManager.getSubscription(),s=i?i.toJSON():{},c=yield this.db.findValue(o.DbKeys.PushData),l=yield u.HelperUtils.getValueIfExist(()=>JSON.parse(c));l&&u.HelperUtils.isPushSimilar(l,s)||(yield this.tryReSubscribingToGrow())||(yield this.removeSubscription(),r=!0)}return r&&(console.log("subscriptionDoesNotExist"),yield u.HelperUtils.sleep(1e3*this.initVars.pushOptInSetting.initialDelay||0)),r})}tryReSubscribingToGrow(){return i(this,void 0,void 0,function*(){try{return yield this.saveSubscription(),!0}catch(t){return console.error(t.message),!1}})}removeSubscription(){return i(this,void 0,void 0,function*(){let t=yield this.swRegistration.pushManager.getSubscription();if(t){let n=yield o.DbManager.Instance();return yield n.clear(o.DbKeys.ClientId),yield n.clear(o.DbKeys.SubscriberId),yield t.unsubscribe()}return!1})}createPushSubscription(){return i(this,void 0,void 0,function*(){let t={userVisibleOnly:!0,applicationServerKey:u.HelperUtils.urlBase64ToUint8Array(this.initVars.vapidKey)};return yield this.swRegistration.pushManager.subscribe(t)})}saveToServer(t){return i(this,void 0,void 0,function*(){let n=Object.assign({userAgent:navigator.userAgent},this.initVars.meta),r={push:t,clientId:this.initVars.clientId,subscriberUniqueId:yield this.db.findValue(o.DbKeys.SubscriberId),meta:n};return yield fetch(this.initVars.subscribeUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})})}}},function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Constants=void 0;class i{}n.Constants=i,i.DefaultOptinTimeout=86400},function(t,n,r){"use strict";var i=this&&this.__awaiter||function(t,n,r,i){return new(r||(r=Promise))(function(o,a){function s(t){try{c(i.next(t))}catch(n){a(n)}}function u(t){try{c(i.throw(t))}catch(n){a(n)}}function c(t){var n;t.done?o(t.value):((n=t.value)instanceof r?n:new r(function(t){t(n)})).then(s,u)}c((i=i.apply(t,n||[])).next())})};Object.defineProperty(n,"__esModule",{value:!0}),n.PopupManager=void 0,r(7);let o=r(11),a=r(12);n.PopupManager=class{constructor(t){this.modalId="grow-consent-modal";let n={modalId:this.modalId,iconUrl:t.pushOptInSetting.message.iconUrl||"",title:t.pushOptInSetting.message.title||"Subscribe to Notifications",body:t.pushOptInSetting.message.body||"",closeText:t.pushOptInSetting.message.buttons.find(t=>1===t.order).label||"Later",subscribeText:t.pushOptInSetting.message.buttons.find(t=>2===t.order).label||"Subscribe"},r='<div class="grow_modal micromodal-slide" id="{{modalId}}" aria-hidden="true"><div class="grow_modal__overlay" tabindex="-1"><div class="grow_modal__container" role="dialog" aria-modal="true"> <main class="grow_modal__content"> <img class="grow_modal__icon" src="{{iconUrl}}"><div class="grow_modal__content_text"><h4 class="grow_modal_title">{{title}}</h4><p class="grow_modal_para"> {{body}}</p></div></main> <footer class="grow_modal__footer"> <a class="grow_modal__btn grow_modal__btn-cancel" aria-label="Close this dialog window">{{closeText}}</a> <button class="grow_modal__btn grow_modal__btn-primary">{{subscribeText}}</button> </footer></div></div></div>';r=(r=(r=(r=(r=(r=r.replace(/{{modalId}}/g,this.modalId)).replace(/{{iconUrl}}/g,n.iconUrl)).replace(/{{title}}/g,n.title)).replace(/{{body}}/g,n.body)).replace(/{{closeText}}/g,n.closeText)).replace(/{{subscribeText}}/g,n.subscribeText);let i=a.render(r,n),s=document.createElement("div");s.innerHTML=i,s=s.firstChild||s;let u=s.querySelector(".grow_modal__btn-primary"),c=s.querySelector(".grow_modal__btn-cancel");u&&u.addEventListener("click",()=>this.subscribeClick(!0)),c&&c.addEventListener("click",()=>this.subscribeClick(!1)),document.body.appendChild(s),o.default.init({awaitCloseAnimation:!0})}show(t){return i(this,void 0,void 0,function*(){return!t||(o.default.show(this.modalId),new Promise(t=>this.confirmationResolve=t))})}subscribeClick(t){return o.default.close(this.modalId),this.confirmationResolve(t)}}},function(t,n,r){var i=r(8),o=r(9);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]),i(o,{insert:"head",singleton:!1}),t.exports=o.locals||{}},function(t,n,r){"use strict";var i,o,a=(i={},function(t){if(void 0===i[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(r){n=null}i[t]=n}return i[t]}),s=[];function u(t){for(var n=-1,r=0;r<s.length;r++)if(s[r].identifier===t){n=r;break}return n}function c(t,n){for(var r={},i=[],o=0;o<t.length;o++){var a=t[o],c=n.base?a[0]+n.base:a[0],l=r[c]||0,d="".concat(c," ").concat(l);r[c]=l+1;var f=u(d),h={css:a[1],media:a[2],sourceMap:a[3]};-1!==f?(s[f].references++,s[f].updater(h)):s.push({identifier:d,updater:v(h,n),references:1}),i.push(d)}return i}function l(t){var n=document.createElement("style"),i=t.attributes||{};if(void 0===i.nonce){var o=r.nc;o&&(i.nonce=o)}if(Object.keys(i).forEach(function(t){n.setAttribute(t,i[t])}),"function"==typeof t.insert)t.insert(n);else{var s=a(t.insert||"head");if(!s)throw Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(n)}return n}var d,f=(d=[],function(t,n){return d[t]=n,d.filter(Boolean).join("\n")});function h(t,n,r,i){var o=r?"":i.media?"@media ".concat(i.media," {").concat(i.css,"}"):i.css;if(t.styleSheet)t.styleSheet.cssText=f(n,o);else{var a=document.createTextNode(o),s=t.childNodes;s[n]&&t.removeChild(s[n]),s.length?t.insertBefore(a,s[n]):t.appendChild(a)}}function p(t,n,r){var i=r.css,o=r.media,a=r.sourceMap;if(o?t.setAttribute("media",o):t.removeAttribute("media"),a&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),t.styleSheet)t.styleSheet.cssText=i;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(i))}}var y=null,g=0;function v(t,n){var r,i,o;if(n.singleton){var a=g++;r=y||(y=l(n)),i=h.bind(null,r,a,!1),o=h.bind(null,r,a,!0)}else r=l(n),i=p.bind(null,r,n),o=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(r)};return i(t),function(n){n?(n.css!==t.css||n.media!==t.media||n.sourceMap!==t.sourceMap)&&i(t=n):o()}}t.exports=function(t,n){(n=n||{}).singleton||"boolean"==typeof n.singleton||(n.singleton=(void 0===o&&(o=Boolean(window&&document&&document.all&&!window.atob)),o));var r=c(t=t||[],n);return function(t){if(t=t||[],"[object Array]"===Object.prototype.toString.call(t)){for(var i=0;i<r.length;i++){var o=u(r[i]);s[o].references--}for(var a=c(t,n),l=0;l<r.length;l++){var d=u(r[l]);0===s[d].references&&(s[d].updater(),s.splice(d,1))}r=a}}}},function(t,n,r){(n=r(10)(!1)).push([t.i,'.grow_modal{font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI","Roboto","Oxygen","Ubuntu","Cantarell","Fira Sans","Droid Sans","Helvetica Neue",sans-serif}.grow_modal *{font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI","Roboto","Oxygen","Ubuntu","Cantarell","Fira Sans","Droid Sans","Helvetica Neue",sans-serif;font-size:0.875rem;opacity:1}.grow_modal__overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.6);display:flex;justify-content:center;align-items:flex-start;z-index:10000}.grow_modal__container{background-color:#fff;padding:15px;width:470px;max-height:100vh;border-radius:0 0 4px 4px;overflow-y:auto;box-sizing:border-box;box-shadow:rgba(0,0,0,0.21) 0px 12px 13px !important}.grow_modal__content{margin-bottom:1rem;line-height:1.5;color:rgba(0,0,0,0.8);flex-direction:row;display:flex}.grow_modal__content .grow_modal__icon{height:76px;width:76px;margin-right:5px;border-radius:4px}.grow_modal__content h4{margin:0 0 1rem;font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI","Roboto","Oxygen","Ubuntu","Cantarell","Fira Sans","Droid Sans","Helvetica Neue",sans-serif;font-size:14px;letter-spacing:1.4px;font-weight:bolder}.grow_modal__content p{margin-top:0;font-size:14px;margin-bottom:1rem;font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI","Roboto","Oxygen","Ubuntu","Cantarell","Fira Sans","Droid Sans","Helvetica Neue",sans-serif}.grow_modal__content .grow_modal__content_text{display:flex;flex-direction:column;margin-left:1rem;font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI","Roboto","Oxygen","Ubuntu","Cantarell","Fira Sans","Droid Sans","Helvetica Neue",sans-serif}.grow_modal__btn,.grow_modal__btn:focus-visible{outline:none;box-shadow:none !important}.grow_modal__btn:focus,.grow_modal__btn:hover{-webkit-transform:scale(1.02)}.grow_modal__btn{font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI","Roboto","Oxygen","Ubuntu","Cantarell","Fira Sans","Droid Sans","Helvetica Neue",sans-serif;padding:.5rem 1rem;background:none;color:rgba(0,0,0,0.8);border-radius:.25rem;border-style:none;border-width:0;cursor:pointer;-webkit-appearance:button;text-transform:none;overflow:visible;line-height:1.15;margin:0;will-change:transform;-moz-osx-font-smoothing:grayscale;-webkit-backface-visibility:hidden;backface-visibility:hidden;-webkit-transform:translateZ(0);transform:translateZ(0);transition:-webkit-transform .25s ease-out;transition:transform .25s ease-out;width:auto;height:auto}.grow_modal__footer{display:flex;justify-content:flex-end;margin-top:0;padding-top:0;border:none;background:transparent}.grow_modal__btn-cancel,.grow_modal__btn-cancel:focus{border:none !important;background-color:white !important;font-size:12.8px;margin-right:5px}.grow_modal__btn-primary{background-color:#2e5fdc;color:#fff;font-size:14px;border:none;border-radius:4px;padding:4px 16px}@keyframes mmfadeIn{from{opacity:0}to{opacity:1}}@keyframes mmfadeOut{from{opacity:1}to{opacity:0}}@keyframes mmslideIn{from{transform:translateY(-15%)}to{transform:translateY(0)}}@keyframes mmslideOut{from{transform:translateY(0)}to{transform:translateY(-10%)}}.micromodal-slide{display:none}.micromodal-slide.is-open{display:block}.micromodal-slide[aria-hidden="false"] .grow_modal__overlay{animation:mmfadeIn 0.3s cubic-bezier(0, 0, 0.2, 1)}.micromodal-slide[aria-hidden="false"] .grow_modal__container{animation:mmslideIn 0.3s cubic-bezier(0, 0, 0.2, 1)}.micromodal-slide[aria-hidden="true"] .grow_modal__overlay{animation:mmfadeOut 0.3s cubic-bezier(0, 0, 0.2, 1)}.micromodal-slide[aria-hidden="true"] .grow_modal__container{animation:mmslideOut 0.3s cubic-bezier(0, 0, 0.2, 1)}.micromodal-slide .grow_modal__container,.micromodal-slide .grow_modal__overlay{will-change:transform}\n',""]),t.exports=n},function(t,n,r){"use strict";t.exports=function(t){var n=[];return n.toString=function(){return this.map(function(n){var r=function(t,n){var r,i,o,a=t[1]||"",s=t[3];if(!s)return a;if(n&&"function"==typeof btoa){var u=(r=s,i=btoa(unescape(encodeURIComponent(JSON.stringify(r)))),o="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(i),"/*# ".concat(o," */"));return[a].concat(s.sources.map(function(t){return"/*# sourceURL=".concat(s.sourceRoot||"").concat(t," */")})).concat([u]).join("\n")}return[a].join("\n")}(n,t);return n[2]?"@media ".concat(n[2]," {").concat(r,"}"):r}).join("")},n.i=function(t,r,i){"string"==typeof t&&(t=[[null,t,""]]);var o={};if(i)for(var a=0;a<this.length;a++){var s=this[a][0];null!=s&&(o[s]=!0)}for(var u=0;u<t.length;u++){var c=[].concat(t[u]);i&&o[c[0]]||(r&&(c[2]?c[2]="".concat(r," and ").concat(c[2]):c[2]=r),n.push(c))}},n}},function(t,n,r){"use strict";function i(t,n){for(var r=0;r<n.length;r++){var i=n[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function o(t){return function(t){if(Array.isArray(t))return a(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,n){if(t){if("string"==typeof t)return a(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);if("Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a(t,n)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,n){(null==n||n>t.length)&&(n=t.length);for(var r=0,i=Array(n);r<n;r++)i[r]=t[r];return i}r.r(n);var s,u,c,l,d,f=(s=["a[href]","area[href]",'input:not([disabled]):not([type="hidden"]):not([aria-hidden])',"select:not([disabled]):not([aria-hidden])","textarea:not([disabled]):not([aria-hidden])","button:not([disabled]):not([aria-hidden])","iframe","object","embed","[contenteditable]",'[tabindex]:not([tabindex^="-"])'],u=function(){var t,n,r;function a(t){var n=t.targetModal,r=t.triggers,i=void 0===r?[]:r,s=t.onShow,u=t.onClose,c=t.openTrigger,l=t.closeTrigger,d=t.openClass,f=t.disableScroll,h=t.disableFocus,p=t.awaitCloseAnimation,y=t.awaitOpenAnimation,g=t.debugMode;(function(t,n){if(!(t instanceof n))throw TypeError("Cannot call a class as a function")})(this,a),this.modal=document.getElementById(n),this.config={debugMode:void 0!==g&&g,disableScroll:void 0!==f&&f,openTrigger:void 0===c?"data-micromodal-trigger":c,closeTrigger:void 0===l?"data-micromodal-close":l,openClass:void 0===d?"is-open":d,onShow:void 0===s?function(){}:s,onClose:void 0===u?function(){}:u,awaitCloseAnimation:void 0!==p&&p,awaitOpenAnimation:void 0!==y&&y,disableFocus:void 0!==h&&h},i.length>0&&this.registerTriggers.apply(this,o(i)),this.onClick=this.onClick.bind(this),this.onKeydown=this.onKeydown.bind(this)}return t=a,n=[{key:"registerTriggers",value:function(){for(var t=this,n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];r.filter(Boolean).forEach(function(n){n.addEventListener("click",function(n){return t.showModal(n)})})}},{key:"showModal",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this.activeElement=document.activeElement,this.modal.setAttribute("aria-hidden","false"),this.modal.classList.add(this.config.openClass),this.scrollBehaviour("disable"),this.addEventListeners(),this.config.awaitOpenAnimation){var r=function n(){t.modal.removeEventListener("animationend",n,!1),t.setFocusToFirstNode()};this.modal.addEventListener("animationend",r,!1)}else this.setFocusToFirstNode();this.config.onShow(this.modal,this.activeElement,n)}},{key:"closeModal",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=this.modal;if(this.modal.setAttribute("aria-hidden","true"),this.removeEventListeners(),this.scrollBehaviour("enable"),this.activeElement&&this.activeElement.focus&&this.activeElement.focus(),this.config.onClose(this.modal,this.activeElement,t),this.config.awaitCloseAnimation){var r=this.config.openClass;this.modal.addEventListener("animationend",function t(){n.classList.remove(r),n.removeEventListener("animationend",t,!1)},!1)}else n.classList.remove(this.config.openClass)}},{key:"closeModalById",value:function(t){this.modal=document.getElementById(t),this.modal&&this.closeModal()}},{key:"scrollBehaviour",value:function(t){if(this.config.disableScroll){var n=document.querySelector("body");switch(t){case"enable":Object.assign(n.style,{overflow:""});break;case"disable":Object.assign(n.style,{overflow:"hidden"})}}}},{key:"addEventListeners",value:function(){this.modal.addEventListener("touchstart",this.onClick),this.modal.addEventListener("click",this.onClick),document.addEventListener("keydown",this.onKeydown)}},{key:"removeEventListeners",value:function(){this.modal.removeEventListener("touchstart",this.onClick),this.modal.removeEventListener("click",this.onClick),document.removeEventListener("keydown",this.onKeydown)}},{key:"onClick",value:function(t){t.target.hasAttribute(this.config.closeTrigger)&&this.closeModal(t)}},{key:"onKeydown",value:function(t){27===t.keyCode&&this.closeModal(t),9===t.keyCode&&this.retainFocus(t)}},{key:"getFocusableNodes",value:function(){var t=this.modal.querySelectorAll(s);return Array.apply(void 0,o(t))}},{key:"setFocusToFirstNode",value:function(){var t=this;if(!this.config.disableFocus){var n=this.getFocusableNodes();if(0!==n.length){var r=n.filter(function(n){return!n.hasAttribute(t.config.closeTrigger)});r.length>0&&r[0].focus(),0===r.length&&n[0].focus()}}}},{key:"retainFocus",value:function(t){var n=this.getFocusableNodes();if(0!==n.length){if(n=n.filter(function(t){return null!==t.offsetParent}),this.modal.contains(document.activeElement)){var r=n.indexOf(document.activeElement);t.shiftKey&&0===r&&(n[n.length-1].focus(),t.preventDefault()),!t.shiftKey&&n.length>0&&r===n.length-1&&(n[0].focus(),t.preventDefault())}else n[0].focus()}}}],i(t.prototype,n),r&&i(t,r),a}(),c=null,l=function(t){if(!document.getElementById(t))return console.warn("MicroModal: âSeems like you have missed %c'".concat(t,"'"),"background-color: #f8f9fa;color: #50596c;font-weight: bold;","ID somewhere in your code. Refer example below to resolve it."),console.warn("%cExample:","background-color: #f8f9fa;color: #50596c;font-weight: bold;",'<div class="modal" id="'.concat(t,'"></div>')),!1},d=function(t,n){var r;if(t.length<=0&&(console.warn("MicroModal: âPlease specify at least one %c'micromodal-trigger'","background-color: #f8f9fa;color: #50596c;font-weight: bold;","data attribute."),console.warn("%cExample:","background-color: #f8f9fa;color: #50596c;font-weight: bold;",'<a href="#" data-micromodal-trigger="my-modal"></a>')),!n)return!0;for(var i in n)l(i);return!0},{init:function(t){var n,r,i,a=Object.assign({},{openTrigger:"data-micromodal-trigger"},t),s=o(document.querySelectorAll("[".concat(a.openTrigger,"]"))),l=(n=s,r=a.openTrigger,i=[],n.forEach(function(t){var n=t.attributes[r].value;void 0===i[n]&&(i[n]=[]),i[n].push(t)}),i);if(!0!==a.debugMode||!1!==d(s,l))for(var f in l){var h=l[f];a.targetModal=f,a.triggers=o(h),c=new u(a)}},show:function(t,n){var r=n||{};r.targetModal=t,!0===r.debugMode&&!1===l(t)||(c&&c.removeEventListeners(),(c=new u(r)).showModal())},close:function(t){t?c.closeModalById(t):c.closeModal()}});window.MicroModal=f,n.default=f},function(t,n,r){t.exports=function(){"use strict";/*!
   * mustache.js - Logic-less {{mustache}} templates with JavaScript
   * http://github.com/janl/mustache.js
   */ var t=Object.prototype.toString,n=Array.isArray||function(n){return"[object Array]"===t.call(n)};function r(t){return"function"==typeof t}function i(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\'{GrowClientJs}'")}function o(t,n){return null!=t&&"object"==typeof t&&n in t}var a=RegExp.prototype.test,s=/\S/;function u(t){var n,r;return n=s,r=t,!a.call(n,r)}var c={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},l=/\s*/,d=/\s+/,f=/\s*=/,h=/\s*\}/,p=/#|\^|\/|>|\{|&|=|!/;function y(t){this.string=t,this.tail=t,this.pos=0}function g(t,n){this.view=t,this.cache={".":this.view},this.parent=n}function v(){this.templateCache={_cache:{},set:function(t,n){this._cache[t]=n},get:function(t){return this._cache[t]},clear:function(){this._cache={}}}}y.prototype.eos=function(){return""===this.tail},y.prototype.scan=function(t){var n=this.tail.match(t);if(!n||0!==n.index)return"";var r=n[0];return this.tail=this.tail.substring(r.length),this.pos+=r.length,r},y.prototype.scanUntil=function(t){var n,r=this.tail.search(t);switch(r){case -1:n=this.tail,this.tail="";break;case 0:n="";break;default:n=this.tail.substring(0,r),this.tail=this.tail.substring(r)}return this.pos+=n.length,n},g.prototype.push=function(t){return new g(t,this)},g.prototype.lookup=function(t){var n,i,a,s=this.cache;if(s.hasOwnProperty(t))n=s[t];else{for(var u,c,l,d=this,f=!1;d;){if(t.indexOf(".")>0)for(u=d.view,c=t.split("."),l=0;null!=u&&l<c.length;)l===c.length-1&&(f=o(u,c[l])||(i=u,a=c[l],null!=i&&"object"!=typeof i&&i.hasOwnProperty&&i.hasOwnProperty(a))),u=u[c[l++]];else u=d.view[t],f=o(d.view,t);if(f){n=u;break}d=d.parent}s[t]=n}return r(n)&&(n=n.call(this.view)),n},v.prototype.clearCache=function(){void 0!==this.templateCache&&this.templateCache.clear()},v.prototype.parse=function(t,r){var o=this.templateCache,a=t+":"+(r||m.tags).join(":"),s=void 0!==o,c=s?o.get(a):void 0;return null==c&&(c=function(t,r){if(!t)return[];var o,a,s,c=!1,g=[],v=[],b=[],$=!1,w=!1,k="",C=0;function x(){if($&&!w)for(;b.length;)delete v[b.pop()];else b=[];$=!1,w=!1}function _(t){if("string"==typeof t&&(t=t.split(d,2)),!n(t)||2!==t.length)throw Error("Invalid tags: "+t);o=RegExp(i(t[0])+"\\s*"),a=RegExp("\\s*"+i(t[1])),s=RegExp("\\s*"+i("}"+t[1]))}_(r||m.tags);for(var I,S,P,T,E,D,A=new y(t);!A.eos();){if(I=A.pos,P=A.scanUntil(o))for(var O=0,K=P.length;O<K;++O)u(T=P.charAt(O))?(b.push(v.length),k+=T):(w=!0,c=!0,k+=" "),v.push(["text",T,I,I+1]),I+=1,"\n"===T&&(x(),k="",C=0,c=!1);if(!A.scan(o))break;if($=!0,S=A.scan(p)||"name",A.scan(l),"="===S?(P=A.scanUntil(f),A.scan(f),A.scanUntil(a)):"{"===S?(P=A.scanUntil(s),A.scan(h),A.scanUntil(a),S="&"):P=A.scanUntil(a),!A.scan(a))throw Error("Unclosed tag at "+A.pos);if(E=">"==S?[S,P,I,A.pos,k,C,c]:[S,P,I,A.pos],C++,v.push(E),"#"===S||"^"===S)g.push(E);else if("/"===S){if(!(D=g.pop()))throw Error('Unopened section "'+P+'" at '+I);if(D[1]!==P)throw Error('Unclosed section "'+D[1]+'" at '+I)}else"name"===S||"{"===S||"&"===S?w=!0:"="===S&&_(P)}if(x(),D=g.pop())throw Error('Unclosed section "'+D[1]+'" at '+A.pos);return function(t){for(var n,r=[],i=r,o=[],a=0,s=t.length;a<s;++a)switch((n=t[a])[0]){case"#":case"^":i.push(n),o.push(n),i=n[4]=[];break;case"/":o.pop()[5]=n[2],i=o.length>0?o[o.length-1][4]:r;break;default:i.push(n)}return r}(function(t){for(var n,r,i=[],o=0,a=t.length;o<a;++o)(n=t[o])&&("text"===n[0]&&r&&"text"===r[0]?(r[1]+=n[1],r[3]=n[3]):(i.push(n),r=n));return i}(v))}(t,r),s&&o.set(a,c)),c},v.prototype.render=function(t,n,r,i){var o=this.getConfigTags(i),a=this.parse(t,o),s=n instanceof g?n:new g(n,void 0);return this.renderTokens(a,s,r,t,i)},v.prototype.renderTokens=function(t,n,r,i,o){for(var a,s,u,c="",l=0,d=t.length;l<d;++l)u=void 0,"#"===(s=(a=t[l])[0])?u=this.renderSection(a,n,r,i,o):"^"===s?u=this.renderInverted(a,n,r,i,o):">"===s?u=this.renderPartial(a,n,r,o):"&"===s?u=this.unescapedValue(a,n):"name"===s?u=this.escapedValue(a,n,o):"text"===s&&(u=this.rawValue(a)),void 0!==u&&(c+=u);return c},v.prototype.renderSection=function(t,i,o,a,s){var u=this,c="",l=i.lookup(t[1]);if(l){if(n(l))for(var d=0,f=l.length;d<f;++d)c+=this.renderTokens(t[4],i.push(l[d]),o,a,s);else if("object"==typeof l||"string"==typeof l||"number"==typeof l)c+=this.renderTokens(t[4],i.push(l),o,a,s);else if(r(l)){if("string"!=typeof a)throw Error("Cannot use higher-order sections without the original template");null!=(l=l.call(i.view,a.slice(t[3],t[5]),function(t){return u.render(t,i,o,s)}))&&(c+=l)}else c+=this.renderTokens(t[4],i,o,a,s);return c}},v.prototype.renderInverted=function(t,r,i,o,a){var s=r.lookup(t[1]);if(!s||n(s)&&0===s.length)return this.renderTokens(t[4],r,i,o,a)},v.prototype.indentPartial=function(t,n,r){for(var i=n.replace(/[^ \t]/g,""),o=t.split("\n"),a=0;a<o.length;a++)o[a].length&&(a>0||!r)&&(o[a]=i+o[a]);return o.join("\n")},v.prototype.renderPartial=function(t,n,i,o){if(i){var a=this.getConfigTags(o),s=r(i)?i(t[1]):i[t[1]];if(null!=s){var u=t[6],c=t[5],l=t[4],d=s;0==c&&l&&(d=this.indentPartial(s,l,u));var f=this.parse(d,a);return this.renderTokens(f,n,i,d,o)}}},v.prototype.unescapedValue=function(t,n){var r=n.lookup(t[1]);if(null!=r)return r},v.prototype.escapedValue=function(t,n,r){var i=this.getConfigEscape(r)||m.escape,o=n.lookup(t[1]);if(null!=o)return"number"==typeof o&&i===m.escape?String(o):i(o)},v.prototype.rawValue=function(t){return t[1]},v.prototype.getConfigTags=function(t){return n(t)?t:t&&"object"==typeof t?t.tags:void 0},v.prototype.getConfigEscape=function(t){return t&&"object"==typeof t&&!n(t)?t.escape:void 0};var m={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(e){b.templateCache=e},get templateCache(){return b.templateCache}},b=new v;return m.clearCache=function(){return b.clearCache()},m.parse=function(t,n){return b.parse(t,n)},m.render=function(t,r,i,o){var a;if("string"!=typeof t)throw TypeError('Invalid template! Template should be a "string" but "'+(n(a=t)?"array":typeof a)+'" was given as the first argument for mustache#render(template, view, partials)');return b.render(t,r,i,o)},m.escape=function(t){return String(t).replace(/[&<>"'`=\/]/g,function(t){return c[t]})},m.Scanner=y,m.Context=g,m.Writer=v,m}()},function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.HelperUtils=void 0,n.HelperUtils=class{static urlBase64ToUint8Array(t){let n=(t+"=".repeat((4-t.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),r=window.atob(n),i=new Uint8Array(r.length);for(let o=0;o<r.length;++o)i[o]=r.charCodeAt(o);return i}static sleep(t){return new Promise(n=>{setTimeout(()=>{n()},t)})}static getValueIfExist(t){try{return t()}catch(n){return}}static isPushSimilar(t,n){return t.endpoint===n.endpoint&&t.keys.p256dh===n.keys.p256dh&&t.keys.auth===n.keys.auth}}}]),async function(){let t=`.gw-float-widget {
  border-radius: 5px 5px 0px 0px;
  top: 50% ;
  position: fixed !important;
  right: 0px ;
  z-index: 1000;
  border: none ;
  padding: 10px 20px;
  font-size: 14px ;
  cursor: pointer ;
  font-weight:  bold ;
  margin-right: 8px;
  transform: translate(45%, -50%) rotate(-90deg);
  -webkit-transform: translate(45%, -50%) rotate(-90deg) ;
  -moz-transform: translate(45%, -50%) rotate(-90deg) ;
  -o-transform: translate(45%, -50%) rotate(-90deg) ;
  -ms-transform: translate(45%, -50%) rotate(-90deg) ;
}

.gw-float-widget[gw-stock-fulfilled] {
  color: #ffffff;
  background-color: #000000;
}

.gw-float-widget[gw-price-drop] {
  color: #ffffff;
  background-color: #000000;
}

.gw-float-widget {
        width: fit-content;
        }
.gw-float-widget[gw-price-drop] {
}
.gw-float-widget[gw-stock-fulfilled] {
}



.gw-modal {
  position: fixed;
  height: 100%;
  width: 100%;
  top: 0;
  z-index: 99999;
  overflow: hidden;
  display: none;
}
.gw-button-widget{
  width:100%;
}
`,n=document.createElement("style");n.type="text/css";let r=document.createTextNode(t);n.appendChild(r),document.head.appendChild(n);let i=GrowClient.default;if(initVar.isPostPurchasePage()&&initVar.sendOrderPurchaseEvent(i),i.onInit=t=>{console.log("subId"+t),initVar.subscriberId=t},i.init(initVar),window.growClient=i,!await i.getClientStatus()){console.log("Client is not active");return}if(initVar.subscriberId=await i.getSubscriberId(),initVar.isPostPurchasePage()&&initVar.sendOrderPurchaseEvent(i),window.growConfig=initVar,window.initVar=initVar,growConfig.registerUtmParameter(),initVar.isCartPage()&&window.growConfig.addToCartClicked(),initVar.customJs){let o=document.createElement("script");o.type="text/javascript";let a=document.createTextNode(initVar.customJs);o.appendChild(a),document.head.appendChild(o)}if(initVar.customCss){let s=document.createElement("style"),u=document.createTextNode(initVar.customCss);s.appendChild(u),document.head.appendChild(s)}initVar.getValueIfExist(()=>{fetch("https://www.cloudflare.com/cdn-cgi/trace",{method:"GET"}).then(async t=>{let n=await t.text();initVar.defaultCountry=n.split("\n").find(t=>t.includes("loc")).split("=")[1].trim()})}),lastPage=null,window.productChangeIntervalSet=!1,window.productChangeIntervalSet||setInterval(async()=>{window.productChangeIntervalSet=!0,window.location.href.includes("products")&&window.location.href!==lastPage&&(lastPage=window.location.href,await initVar.registerOnVariantChange(),await initVar.registerAddToCartChange(),await initVar.onVariantChange())},500)}()));